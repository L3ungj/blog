"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[737],{5044:(e,t,n)=>{n.r(t),n.d(t,{Arrow:()=>e5,Badge:()=>tl,CameraControls:()=>tp,Cluster:()=>e1,Edge:()=>e6,Edges:()=>te,FORCE_LAYOUTS:()=>el,GraphCanvas:()=>tk,GraphScene:()=>tg,Icon:()=>tr,Label:()=>eY,Lasso:()=>tx,Line:()=>e7,Node:()=>ts,RadialMenu:()=>tO,RadialSlice:()=>tP,Ring:()=>tt,Sphere:()=>tn,SphereWithIcon:()=>to,SphereWithSvg:()=>ta,Svg:()=>ti,addColorAttribute:()=>eT,animationConfig:()=>ex,attributeSizing:()=>eh,buildClusterGroups:()=>eN,buildGraph:()=>eb,buildNodeEdges:()=>Q,calcLabelVisibility:()=>ec,calculateClusters:()=>eL,calculateEdgeCurveOffset:()=>ej,calculateSubLabelOffset:()=>eI,centralitySizing:()=>ep,circular2d:()=>et,concentric2d:()=>Y,createDashedGeometry:()=>eB,createElement:()=>tv,createNullGeometry:()=>eR,custom:()=>ea,darkTheme:()=>th,findPath:()=>e_,forceAtlas2:()=>ei,forceDirected:()=>ee,forceInABox:()=>J,forceRadial:()=>Z,getAdjacents:()=>ty,getArrowSize:()=>ew,getArrowVectors:()=>eC,getClosestAxis:()=>tu,getCurve:()=>ez,getCurvePoints:()=>ek,getDegreesToClosest2dAxis:()=>tf,getExpandPath:()=>eK,getLabelOffsetByType:()=>eu,getLayoutCenter:()=>eS,getMidPoint:()=>eE,getNodeDepth:()=>W,getSelfLoopCurve:()=>eM,getVector:()=>eP,getVisibleEntities:()=>eG,hierarchical:()=>er,isNodeInView:()=>tc,isNotEditableElement:()=>eD,isServerRender:()=>ef,layoutProvider:()=>es,lightTheme:()=>tm,nodeSizeProvider:()=>ey,nooverlap:()=>eo,pageRankSizing:()=>eg,prepareRay:()=>tb,recommendLayout:()=>ed,tick:()=>K,transformGraph:()=>ev,updateNodePosition:()=>eO,useCollapse:()=>eQ,useGraph:()=>eH,useSelection:()=>tz});var r=n(5155),o=n(2115),i=n(6026),a=n(258),l=n(7483),s=n(3020),d=n(5844),c=n(8977),u=n(3926),f=n(7795),g=n(4132),p=n(3079),h=n(734),m=n(7723),y=n(4716),b=n(9555),v=n(4793),x=n(2777),C=n(9767),w=n(8494),E=n(271),k=n(4341),z=n(618),M=n(399),P=n(3082),A=n(1138),O=n(4538),j=n(3780),I=n(6491),S=n(1412),N=n(8225),L=n(1856),_=n(1955),D=n(3234),R=n(6923),T=n(4816),B=n(3646),F=n(8922),$=n(2093),V=n(5043),q=n(2740),U=n(7940),G=n(5203);function K(e){return new Promise((t,n)=>{let r;!function n(){r?t(r):(r=e.step(),n())}()})}function Q(e){let t=[],n=[];return e.forEachNode((e,n)=>{t.push({...n,id:e,radius:n.size||1})}),e.forEachEdge((e,t)=>{n.push({...t,id:e})}),{nodes:t,edges:n}}function H(e,t,n){let r=Math.acos(1-2*(e+.5)/t),o=Math.PI*(1+Math.sqrt(5))*(e+.5),i=n*Math.sin(r)*Math.cos(o),a=n*Math.sin(r)*Math.sin(o),s=n*Math.cos(r);return new l.Pq0(i,a,s)}function Y({graph:e,radius:t=40,drags:n,getNodePosition:r,concentricSpacing:o=100}){let{nodes:i,edges:a}=Q(e),l={},s=e=>Math.floor(2*Math.PI*(t+e*o)/40),d=new Map,c=[];for(let t of i){let n=e.getNodeAttribute(t.id,"data"),r=n?.level;"number"==typeof r&&r>=0?(d.has(r)||d.set(r,[]),d.get(r).push(t.id)):c.push({id:t.id,metric:e.degree(t.id)})}for(let[e,n]of(c.sort((e,t)=>t.metric-e.metric),d.entries())){let r=n.length,i=t+e*o;for(let e=0;e<r;e++){let t=2*Math.PI*e/r;l[n[e]]={x:i*Math.cos(t),y:i*Math.sin(t)}}}let u=new Set(d.keys()),f=0,g=0;for(;g<c.length;){for(;u.has(f);)f++;let e=s(f),n=t+f*o;for(let t=0;t<e&&g<c.length;t++){let r=2*Math.PI*t/e;l[c[g].id]={x:n*Math.cos(r),y:n*Math.sin(r)},g++}f++}return{step:()=>!0,getNodePosition(t){if(r){let o=r(t,{graph:e,drags:n,nodes:i,edges:a});if(o)return o}return n?.[t]?.position?n[t].position:l[t]}}}function W(e,t){let n=!1,r=e.reduce((e,t)=>({...e,[t.id]:{data:t,out:[],depth:-1,ins:[]}}),{});try{for(let e of t){let t=e.source,n=e.target;if(!r.hasOwnProperty(t))throw Error(`Missing source Node ${t}`);if(!r.hasOwnProperty(n))throw Error(`Missing target Node ${n}`);let o=r[t],i=r[n];i.ins.push(o),o.out.push(i)}!function e(t,n=[]){let r=n.length;for(let o of t){let t=n.indexOf(o);if(t>-1){let e=[...n.slice(t),o].map(e=>e.data.id);throw Error(`Invalid Graph: Circular node path detected: ${e.join(" -> ")}.`)}r>o.depth&&(o.depth=r,e(o.out,[...n,o]))}}(Object.values(r))}catch(e){n=!0}let o=Math.max(...Object.keys(r).map(e=>r[e].depth));return{invalid:n,depths:r,maxDepth:o||1}}!function(){try{if("undefined"!=typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode("._canvas_670zp_1 {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n._container_155l7_1 {\n  transform-origin: bottom right;\n  overflow: hidden;\n  position: absolute;\n  border: solid 1px var(--radial-menu-border);\n}\n\n  ._container_155l7_1._disabled_155l7_7 {\n    opacity: 0.6;\n  }\n\n  ._container_155l7_1._disabled_155l7_7 ._contentContainer_155l7_10 {\n      cursor: not-allowed;\n    }\n\n  ._container_155l7_1:not(._disabled_155l7_7) ._contentContainer_155l7_10 {\n      cursor: pointer;\n    }\n\n  ._container_155l7_1:not(._disabled_155l7_7) ._contentContainer_155l7_10:hover {\n        color: var(--radial-menu-active-color);\n        background: var(--radial-menu-active-background);\n      }\n\n  ._container_155l7_1 ._contentContainer_155l7_10 {\n    width: 200%;\n    height: 200%;\n    transform-origin: 50% 50%;\n    border-radius: 50%;\n    outline: none;\n    transition: background 150ms ease-in-out;\n    color: var(--radial-menu-color);\n  }\n\n  ._container_155l7_1 ._contentContainer_155l7_10 ._contentInner_155l7_35 {\n      position: absolute;\n      width: 100%;\n      text-align: center;\n    }\n\n  ._container_155l7_1 ._contentContainer_155l7_10 ._contentInner_155l7_35 ._content_155l7_10 {\n        display: inline-block;\n      }\n\n  ._container_155l7_1 svg {\n    margin: 0 auto;\n    fill: var(--radial-menu-active-color);\n    height: 25px;\n    width: 25px;\n    display: block;\n  }\n._container_x9hyx_1 {\n  border-radius: 50%;\n  z-index: 9;\n  position: relative;\n  height: 175px;\n  width: 175px;\n  border: solid 5px var(--radial-menu-border);\n  overflow: hidden;\n  background: var(--radial-menu-background);\n}\n\n  ._container_x9hyx_1:before {\n    content: ' ';\n    background: var(--radial-menu-border);\n    border-radius: 50%;\n    height: 25px;\n    width: 25px;\n    position: absolute;\n    z-index: 9;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }")),document.head.appendChild(e)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}}();let X=["radialin","radialout"];function Z({nodes:e,edges:t,mode:n="lr",nodeLevelRatio:r=2}){let{depths:o,maxDepth:i,invalid:a}=W(e,t);if(a)return null;let l=X.includes(n)?1:5,d=e.length/i*r*l;if(n){let t=(e,t)=>n=>e?(o[n.id].depth-i/2)*d*(t?-1:1):void 0,r=t(["lr","rl"].includes(n),"rl"===n),a=t(["td","bu"].includes(n),"td"===n),l=t(["zin","zout"].includes(n),"zout"===n);e.forEach(e=>{e.fx=r(e),e.fy=a(e),e.fz=l(e)})}return X.includes(n)?(0,s.A)(e=>{let t=o[e.id];return("radialin"===n?i-t.depth:t.depth)*d}).strength(1):null}function J(){let e,t,n=e=>()=>e,r=e=>e.index,o=[],i=[],a=[100,100],l=n(1),s=n(-1),h=n(100),m=n(.1),v={},x=.1,C=.001,w=[],E=[0,0],k=e=>e.cluster,z="treemap",M=!0,P=.1;function A(e){if(!M)return A;"force"===z&&(t.tick(),I());for(let t=0,n=o.length,r,i=e*P;t<n;++t)r=o[t],r.vx+=(v[k(r)].x-r.x)*i,r.vy+=(v[k(r)].y-r.y)*i}function O(){o&&("treemap"===z?(w=(0,y.A)().size(A.size())((0,b.Ay)(function(){let e,t,n,r=[];for(e of(n=j(A.nodes())).keys())t=n.get(e),r.push({id:e,size:t.count});return{id:"clustersTree",children:r}}()).sum(e=>e.radius).sort(function(e,t){return t.height-e.height||t.value-e.value})).leaves(),I()):function(){let n;if(o&&o.length){let r;r=0,0!==o.length&&i.forEach(function(e){let t,n;if(o){if(t=e.source,n=e.target,"object"!=typeof e.source&&(t=o.find(t=>t.id===e.source)),"object"!=typeof e.target&&(n=o.find(t=>t.id===e.target)),void 0===t||void 0===n)throw Error("Error setting links, couldnt find nodes for a link (see it on the console)");e.source=t,e.target=n,e.index=r++}}),n=function(){var e;let t,n,r,a,l,s,d=[],c=[],u=new Map;for(r of(s=j(o),e=i,t=new Map,n=[],e.forEach(function(e){let n,r,o=(n=k(e.source))<=(r=k(e.target))?n+"~"+r:r+"~"+n,i;i=(t.has(o)?t.get(o):0)+1,t.set(o,i)}),t.forEach(function(e,t){let r,o;r=t.split("~")[0],o=t.split("~")[1],void 0!==r&&void 0!==o&&n.push({source:r,target:o,count:e})}),s.keys()))l=s.get(r),d.push({id:r,size:l.count,r:Math.sqrt(l.sumforceNodeSize/Math.PI)}),u.set(r,a);return n.forEach(function(e){let t=u.get(e.source),n=u.get(e.target);void 0!==t&&void 0!==n&&c.push({source:t,target:n,count:e.count})}),{nodes:d,links:c}}(),e.size>0&&n.nodes.forEach(t=>{t.fx=e.get(t.id)?.position?.x,t.fy=e.get(t.id)?.position?.y}),w=(t=(0,d.A)(n.nodes).force("x",(0,c.A)(a[0]/2).strength(.1)).force("y",(0,u.A)(a[1]/2).strength(.1)).force("collide",(0,f.A)(e=>e.r).iterations(4)).force("charge",(0,g.A)().strength(s)).force("links",(0,p.A)(n.nodes.length?n.links:[]).distance(h).strength(m))).nodes(),I()}}())}function j(e){let t=new Map,n={};return e.forEach(function(e){t.has(k(e))||t.set(k(e),{count:0,sumforceNodeSize:0})}),e.forEach(function(e){(n=t.get(k(e))).count=n.count+1,n.sumforceNodeSize=n.sumforceNodeSize+Math.PI*(l(e)*l(e))*1.3,t.set(k(e),n)}),t}function I(){return v.none={x:0,y:0},w.forEach(function(e){"treemap"===z?v[e.data.id]={x:e.x0+(e.x1-e.x0)/2-E[0],y:e.y0+(e.y1-e.y0)/2-E[1]}:v[e.id]={x:e.x-E[0],y:e.y-E[1]}}),v}return A.initialize=function(e){o=e,O()},A.template=function(e){return arguments.length?(z=e,O(),A):z},A.groupBy=function(e){return arguments.length?("string"==typeof e?k=function(t){return t[e]}:k=e,A):k},A.enableGrouping=function(e){return arguments.length?(M=e,A):M},A.strength=function(e){return arguments.length?(P=e,A):P},A.getLinkStrength=function(e){if(M)if(k(e.source)===k(e.target))if("function"==typeof x)return x(e);else return x;else if("function"==typeof C)return C(e);else return C;return"function"==typeof x?x(e):x},A.id=function(e){return arguments.length?(r=e,A):r},A.size=function(e){return arguments.length?(a=e,A):a},A.linkStrengthInterCluster=function(e){return arguments.length?(C=e,A):C},A.linkStrengthIntraCluster=function(e){return arguments.length?(x=e,A):x},A.nodes=function(e){return arguments.length?(o=e,A):o},A.links=function(e){return arguments.length?(i=null===e?[]:e,O(),A):i},A.template=function(e){return arguments.length?(z=e,O(),A):z},A.forceNodeSize=function(e){return arguments.length?(l="function"==typeof e?e:n(+e),O(),A):l},A.nodeSize=A.forceNodeSize,A.forceCharge=function(e){return arguments.length?(s="function"==typeof e?e:n(+e),O(),A):s},A.forceLinkDistance=function(e){return arguments.length?(h="function"==typeof e?e:n(+e),O(),A):h},A.forceLinkStrength=function(e){return arguments.length?(m="function"==typeof e?e:n(+e),O(),A):m},A.offset=function(e){return arguments.length?(E="function"==typeof e?e:n(+e),A):E},A.getFocis=I,A.setClusters=function(t){return e=t,A},A}function ee({graph:e,nodeLevelRatio:t=2,mode:n=null,dimensions:r=2,nodeStrength:o=-250,linkDistance:i=50,clusterStrength:a=.5,linkStrengthInterCluster:l=.01,linkStrengthIntraCluster:s=.5,forceLinkDistance:y=100,forceLinkStrength:b=.1,clusterType:v="force",forceCharge:x=-700,getNodePosition:C,drags:w,clusters:E,clusterAttribute:k,forceLayout:z}){let M,P,A,{nodes:O,edges:j}=Q(e),I=2===r&&j.length>25?2*o:o;"forceDirected2d"===z?(M=(0,c.A)(),P=(0,u.A)()):(M=(0,c.A)(600).strength(.05),P=(0,u.A)(600).strength(.05));let S=(0,d.A)().force("center",(0,h.A)(0,0)).force("link",(0,p.A)()).force("charge",(0,g.A)().strength(I)).force("x",M).force("y",P).force("z",(0,m.A)()).force("collide",(0,f.A)(e=>e.radius+10)).force("dagRadial",Z({nodes:O,edges:j,mode:n,nodeLevelRatio:t})).stop();if(k){let e=x;O?.length&&(e=x*Math.ceil(O.length/200)),A=J().setClusters(E).strength(a).template(v).groupBy(e=>e.data[k]).links(j).size([100,100]).linkStrengthInterCluster(l).linkStrengthIntraCluster(s).forceLinkDistance(y).forceLinkStrength(b).forceCharge(e).forceNodeSize(e=>e.radius)}let N=S.numDimensions(r).nodes(O);if(A&&(N=N.force("group",A)),i){let e=N.force("link");e&&(e.id(e=>e.id).links(j).distance(i),A&&(e=e.strength(A?.getLinkStrength??.1)))}let L=new Map(O.map(e=>[e.id,e]));return{step(){for(;S.alpha()>.01;)S.tick();return!0},getNodePosition(t){if(C){let n=C(t,{graph:e,drags:w,nodes:O,edges:j});if(n)return n}return w?.[t]?.position?w?.[t]?.position:L.get(t)}}}function et({graph:e,radius:t,drags:n,getNodePosition:r}){let o=C(e,{scale:t}),{nodes:i,edges:a}=Q(e);return{step:()=>!0,getNodePosition(t){if(r){let o=r(t,{graph:e,drags:n,nodes:i,edges:a});if(o)return o}return n?.[t]?.position?n?.[t]?.position:o?.[t]}}}let en={td:{x:"x",y:"y",factor:-1},lr:{x:"y",y:"x",factor:1}};function er({graph:e,drags:t,mode:n="td",nodeSeparation:r=1,nodeSize:o=[50,50],getNodePosition:i}){let{nodes:a,edges:l}=Q(e),{depths:s}=W(a,l),d=Object.keys(s).map(e=>s[e]),c=(0,v.A)().id(e=>e.data.id).parentId(e=>e.ins?.[0]?.data?.id)(d),u=(0,x.A)().separation(()=>r).nodeSize(o)((0,b.Ay)(c)).descendants(),f=en[n],g=new Map(a.map(e=>{let{x:t,y:n}=u.find(t=>t.data.id===e.id);return[e.id,{...e,[f.x]:t*f.factor,[f.y]:n*f.factor,z:0}]}));return{step:()=>!0,getNodePosition(n){if(i){let r=i(n,{graph:e,drags:t,nodes:a,edges:l});if(r)return r}return t?.[n]?.position?t?.[n]?.position:g.get(n)}}}function eo({graph:e,margin:t,drags:n,getNodePosition:r,ratio:o,gridSize:i,maxIterations:a}){let{nodes:l,edges:s}=Q(e),d=w(e,{maxIterations:a,inputReducer:(e,t)=>({...t,x:t.x||0,y:t.y||0}),settings:{ratio:o,margin:t,gridSize:i}});return{step:()=>!0,getNodePosition(t){if(r){let o=r(t,{graph:e,drags:n,nodes:l,edges:s});if(o)return o}return n?.[t]?.position?n?.[t]?.position:d?.[t]}}}function ei({graph:e,drags:t,iterations:n,...r}){k.assign(e);let o=E(e,{iterations:n,settings:r});return{step:()=>!0,getNodePosition:e=>t?.[e]?.position||o?.[e]}}function ea({graph:e,drags:t,getNodePosition:n}){let{nodes:r,edges:o}=Q(e);return{step:()=>!0,getNodePosition:i=>n(i,{graph:e,drags:t,nodes:r,edges:o})}}let el=["forceDirected2d","treeTd2d","treeLr2d","radialOut2d","treeTd3d","treeLr3d","radialOut3d","forceDirected3d"];function es({type:e,...t}){if(el.includes(e)){let{nodeStrength:n,linkDistance:r,nodeLevelRatio:o}=t;if("forceDirected2d"===e)return ee({...t,dimensions:2,nodeLevelRatio:o||2,nodeStrength:n||-250,linkDistance:r,forceLayout:e});if("treeTd2d"===e)return ee({...t,mode:"td",dimensions:2,nodeLevelRatio:o||5,nodeStrength:n||-250,linkDistance:r||50,forceLayout:e});if("treeLr2d"===e)return ee({...t,mode:"lr",dimensions:2,nodeLevelRatio:o||5,nodeStrength:n||-250,linkDistance:r||50,forceLayout:e});else if("radialOut2d"===e)return ee({...t,mode:"radialout",dimensions:2,nodeLevelRatio:o||5,nodeStrength:n||-500,linkDistance:r||100,forceLayout:e});else if("treeTd3d"===e)return ee({...t,mode:"td",dimensions:3,nodeLevelRatio:o||2,nodeStrength:n||-500,linkDistance:r||50});else if("treeLr3d"===e)return ee({...t,mode:"lr",dimensions:3,nodeLevelRatio:o||2,nodeStrength:n||-500,linkDistance:r||50,forceLayout:e});else if("radialOut3d"===e)return ee({...t,mode:"radialout",dimensions:3,nodeLevelRatio:o||2,nodeStrength:n||-500,linkDistance:r||100,forceLayout:e});else if("forceDirected3d"===e)return ee({...t,dimensions:3,nodeLevelRatio:o||2,nodeStrength:n||-250,linkDistance:r,forceLayout:e})}else if("circular2d"===e){let{radius:e}=t;return et({...t,radius:e||300})}else if("concentric2d"===e)return Y(t);else if("concentric3d"===e)return function({graph:e,radius:t=40,drags:n,getNodePosition:r,concentricSpacing:o=100}){let{nodes:i,edges:a}=Q(e),l={},s=e=>Math.floor(2*Math.PI*(t+e*o)/40),d=new Map,c=[];for(let t of i){let n=e.getNodeAttribute(t.id,"data"),r=n?.level;"number"==typeof r&&r>=0?(d.has(r)||d.set(r,[]),d.get(r).push(t.id)):c.push({id:t.id,metric:e.degree(t.id)})}for(let[e,n]of(c.sort((e,t)=>t.metric-e.metric),d.entries())){let r=n.length,i=t+e*o;for(let[e,t]of n.entries()){let n=H(e,r,i);l[t]={x:n.x,y:n.y,z:n.z}}}let u=new Set(d.keys()),f=0,g=0;for(;g<c.length;){for(;u.has(f);)f++;let e=s(f),n=t+f*o;for(let t=0;t<e&&g<c.length;t++){let r=H(t,e,n);l[c[g].id]={x:r.x,y:r.y,z:r.z},g++}f++}return{step:()=>!0,getNodePosition(t){if(r){let o=r(t,{graph:e,drags:n,nodes:i,edges:a});if(o)return o}return n?.[t]?.position?n[t].position:l[t]}}}(t);else if("hierarchicalTd"===e)return er({...t,mode:"td"});else if("hierarchicalLr"===e)return er({...t,mode:"lr"});else if("nooverlap"===e){let{graph:e,maxIterations:n,ratio:r,margin:o,gridSize:i,...a}=t;return eo({graph:e,margin:o||10,maxIterations:n||50,ratio:r||10,gridSize:i||20,...a})}else if("forceatlas2"===e){let{graph:e,iterations:n,gravity:r,scalingRatio:o,...i}=t;return ei({type:"forceatlas2",graph:e,...i,scalingRatio:o||100,gravity:r||10,iterations:n||50})}else if("custom"===e)return ea({...t});throw Error(`Layout ${e} not found.`)}function ed(e,t){let{invalid:n}=W(e,t),r=e.length;if(!n)if(r>100)return"radialOut2d";else return"treeTd2d";return"forceDirected2d"}function ec({nodePosition:e,labelType:t,camera:n}){return(r,o)=>{let i="all"===t||"nodes"===t&&"node"===r||"edges"===t&&"edge"===r;if(!i&&n&&e&&n?.position?.z/n?.zoom-e?.z>6e3)return!1;if(i)return!0;if("auto"===t&&"node"===r){if(o>7)return!0;else if(n&&e&&n.position.z/n.zoom-e.z<3e3)return!0}return!1}}function eu(e,t){switch(t){case"above":return e;case"below":return-e;default:return 0}}let ef="undefined"==typeof window;function eg({graph:e}){let t=z(e);return{ranks:t,getSizeForNode:e=>80*t[e]}}function ep({graph:e}){let t=(0,M.degreeCentrality)(e);return{ranks:t,getSizeForNode:e=>20*t[e]}}function eh({graph:e,attribute:t,defaultSize:n}){let r=new Map;return t?e.forEachNode((e,n)=>{let o=n.data?.[t];isNaN(o)&&console.warn(`Attribute ${o} is not a number for node ${n.id}`),r.set(e,o||0)}):console.warn("Attribute sizing configured but no attribute provided"),{getSizeForNode:e=>t&&r?r.get(e):n}}let em={pagerank:eg,centrality:ep,attribute:eh,none:({defaultSize:e})=>({getSizeForNode:t=>e})};function ey({type:e,...t}){let n,r,o=em[e]?.(t);if(!o&&"default"!==e)throw Error(`Unknown sizing strategy: ${e}`);let{graph:i,minSize:a,maxSize:l}=t,s=new Map;if(i.forEachNode((i,a)=>{let l;l="default"===e?a.size||t.defaultSize:o.getSizeForNode(i),(void 0===n||l<n)&&(n=l),(void 0===r||l>r)&&(r=l),s.set(i,l)}),"none"!==e){let e=(0,P.A)().domain([n,r]).rangeRound([a,l]);for(let[t,n]of s)s.set(t,e(n))}return s}function eb(e,t,n){e.clear();let r=new Set;for(let n of t)try{r.has(n.id)||(e.addNode(n.id,n),r.add(n.id))}catch(e){console.error(`[Graph] Error adding node '${n.id}`,e)}for(let t of n)if(r.has(t.source)&&r.has(t.target))try{e.addEdge(t.source,t.target,t)}catch(e){console.error(`[Graph] Error adding edge '${t.source} -> ${t.target}`,e)}return e}function ev({graph:e,layout:t,sizingType:n,labelType:r,sizingAttribute:o,defaultNodeSize:i,minNodeSize:a,maxNodeSize:l,clusterAttribute:s}){let d=[],c=[],u=new Map,f=ey({graph:e,type:n,attribute:o,minSize:a,maxSize:l,defaultSize:i});e.nodes().length;let g=ec({labelType:r});return e.forEachNode((n,r)=>{let o=t.getNodePosition(n),{data:i,fill:a,icon:l,label:c,size:p,...h}=r,m=f.get(r.id),y=g("node",m),b=(e.inboundNeighbors(r.id)||[]).map(t=>e.getNodeAttributes(t)),v={...r,size:m,labelVisible:y,label:c,icon:l,fill:a,cluster:s?i[s]:void 0,parents:b,data:{...h,...i??{}},position:{...o,x:o.x||0,y:o.y||0,z:o.z||1}};u.set(r.id,v),d.push(v)}),e.forEachEdge((e,t)=>{let n=u.get(t.source),r=u.get(t.target);if(n&&r){let{data:e,id:n,label:r,size:o,...i}=t,a=g("edge",o);c.push({...t,id:n,label:r,labelVisible:a,size:o,data:{...i,id:n,...e||{}}})}}),{nodes:d,edges:c}}let ex={mass:10,tension:1e3,friction:300,precision:.1};function eC(e,t,n){let r=t.getLength(),o=(("end"===e?r:r/2)-("end"===e?n/2:0))/r;return[t.getPointAt(o),t.getTangentAt(o)]}function ew(e){return[e+6,2+e/1.5]}function eE(e,t,n=0){let r=new l.Pq0(e.x,e.y||0,e.z||0),o=new l.Pq0(t.x,t.y||0,t.z||0),i=new l.Pq0().addVectors(r,o).divideScalar(2);return i.setLength(i.length()+n)}function ek(e,t,n=-1){let r=e.clone(),o=t.clone(),i=new l.Pq0().subVectors(o,r),a=i.length(),s=i.clone().normalize(),d=new l.Pq0().subVectors(o,r).divideScalar(2),c=Math.abs(s.x)%1,u=new l.Pq0(-s.y,s.x-c*s.z,c*s.y).normalize();return[e,new l.Pq0().add(r).add(d).add(u.multiplyScalar(a/4).multiplyScalar(n)),t]}function ez(e,t,n,r,o,i){let a=eA(e,n,t),s=eA(n,e,r);return o?new l.CV9(...ek(a,s,i)):new l.VnP(a,s)}function eM(e){let t=eP(e),n=e.size,r=Math.PI/2,o=t.clone().add(new l.Pq0(n*Math.cos(r),1.3*n*Math.sin(r),0)),i=[];for(let e=0;e<10;e++){let t=e/10*2*Math.PI;i.push(o.clone().add(new l.Pq0(n*Math.cos(t),n*Math.sin(t),0)))}return new l.B6O(i,!0)}function eP(e){return new l.Pq0(e.position.x,e.position.y,e.position.z||0)}function eA(e,t,n){let r=e.distanceTo(t);return e.clone().add(t.clone().sub(e).multiplyScalar(n/r))}function eO(e,t){return{...e,position:{...e.position,x:e.position.x+t.x,y:e.position.y+t.y,z:e.position.z+t.z}}}function ej({edge:e,edges:t,curved:n}){let r,o=n,i=t.filter(t=>t.target===e.target&&t.source===e.source).map(e=>e.id);if(i.length>1){o=!0;let t=i.indexOf(e.id);r=.7*(0===t?1:1+.8*t)*(t%2==0?1:-1)}return e.data?.isAggregated&&t.length>1?{curved:!0,curveOffset:0===i.indexOf(e.id)?.7:-.7}:{curved:o,curveOffset:r}}function eI(e,t,n){let r=t.x-e.x,o=Math.atan2(t.y-e.y,r),i="above"===n?r>=0?o+Math.PI/2:o-Math.PI/2:r>=0?o-Math.PI/2:o+Math.PI/2;return{x:7*Math.cos(i),y:7*Math.sin(i),z:0}}function eS(e){let t=1/0,n=-1/0,r=1/0,o=-1/0,i=1/0,a=-1/0;for(let l of e)t=Math.min(t,l.position.x),n=Math.max(n,l.position.x),r=Math.min(r,l.position.y),o=Math.max(o,l.position.y),i=Math.min(i,l.position.z),a=Math.max(a,l.position.z);return{height:o-r,width:n-t,minX:t,maxX:n,minY:r,maxY:o,minZ:i,maxZ:a,x:(n+t)/2,y:(o+r)/2,z:(a+i)/2}}function eN(e,t){return t?e.reduce((e,n)=>{let r=n.data[t];return r&&e.set(r,[...e.get(r)||[],n]),e},new Map):new Map}function eL({nodes:e,clusterAttribute:t}){let n=new Map;if(t)for(let[r,o]of eN(e,t)){let e=eS(o);n.set(r,{label:r,nodes:o,position:e})}return n}function e_(e,t,n){return(0,j.bidirectional)(e,t,n)}let eD=e=>"INPUT"!==e.tagName&&"SELECT"!==e.tagName&&"TEXTAREA"!==e.tagName&&!e.isContentEditable,eR=()=>{let e=new l.iNn(0,0,0),t=e.attributes.position.count,n=new Float32Array(3*t);for(let e=0;e<t;e++)n[3*e]=1,n[3*e+1]=1,n[3*e+2]=1;return e.setAttribute("color",new l.qtW(n,3)),e},eT=(e,t)=>{let n=e.attributes.position.count,r=new Float32Array(3*n);for(let e=0;e<n;e++)r[3*e]=t.r,r[3*e+1]=t.g,r[3*e+2]=t.b;e.setAttribute("color",new l.qtW(r,3))},eB=(e,t,n,r=[3,1])=>{let[o,i]=r,a=o+i,s=Math.max(3,Math.floor(e.getLength()/a)),d=[];for(let r=0;r<s;r++){let i=r/s,c=i+o/a/s;if(c>i&&i<1){let r=[],o=Math.max(3,Math.floor(8*(c-i)));for(let t=0;t<=o;t++){let n=i+t/o*(c-i);n<=1&&r.push(e.getPointAt(n))}if(r.length>=2){let e=new l.B6O(r),o=new l.j6(e,Math.max(2,r.length-1),t,5,!1);eT(o,n),d.push(o)}}}return d.length>0?(0,I.h0)(d):new l.LoY},eF=({actives:e=[],selections:t=[],collapsedNodeIds:n=[],theme:r})=>(0,A.v)(o=>({theme:{...r,edge:{...r?.edge,label:{...r?.edge?.label,fontSize:r?.edge?.label?.fontSize??6}}},edges:[],nodes:[],collapsedNodeIds:n,clusters:new Map,panning:!1,draggingIds:[],actives:e,hoveredEdgeIds:[],edgeContextMenus:new Set,edgeMeshes:[],selections:t,hoveredNodeId:null,drags:{},graph:new N.Ay({multi:!0}),setTheme:e=>o(t=>({...t,theme:e})),setClusters:e=>o(t=>({...t,clusters:e})),setEdgeContextMenus:e=>o(t=>({...t,edgeContextMenus:e})),setEdgeMeshes:e=>o(t=>({...t,edgeMeshes:e})),setPanning:e=>o(t=>({...t,panning:e})),setDrags:e=>o(t=>({...t,drags:e})),addDraggingId:e=>o(t=>({...t,draggingIds:[...t.draggingIds,e]})),removeDraggingId:e=>o(t=>({...t,draggingIds:t.draggingIds.filter(t=>t!==e)})),setActives:e=>o(t=>({...t,actives:e})),setSelections:e=>o(t=>({...t,selections:e})),setHoveredNodeId:e=>o(t=>({...t,hoveredNodeId:e})),setHoveredEdgeIds:e=>o(t=>({...t,hoveredEdgeIds:e})),setNodes:e=>o(t=>({...t,nodes:e,centerPosition:eS(e)})),setEdges:e=>o(t=>({...t,edges:e})),setNodePosition:(e,t)=>o(n=>{let r=n.nodes.find(t=>t.id===e),o=eP(r),i=new l.Pq0(t.x,t.y,t.z).sub(o),a=[...n.nodes];return n.selections?.includes(e)?n.selections?.forEach(e=>{let t=n.nodes.find(t=>t.id===e);t&&(a[n.nodes.indexOf(t)]=eO(t,i))}):a[n.nodes.indexOf(r)]=eO(r,i),{...n,drags:{...n.drags,[e]:r},nodes:a}}),setCollapsedNodeIds:(e=[])=>o(t=>({...t,collapsedNodeIds:e})),setClusterPosition:(e,t)=>o(n=>{let r=new Map(n.clusters),o=r.get(e);if(o){let i=o.position,a=new l.Pq0(t.x-i.x,t.y-i.y,t.z-(i.z??0)),s=[...n.nodes],d={...n.drags};s.forEach((t,n)=>{t.cluster===e&&(s[n]={...t,position:{...t.position,x:t.position.x+a.x,y:t.position.y+a.y,z:t.position.z+(a.z??0)}},d[t.id]=t)});let c=eS(s.filter(t=>t.cluster===e));return r.set(e,{...o,position:c}),{...n,drags:{...d,[e]:o},clusters:r,nodes:s}}return n})})),e$=eF({}),eV=ef?null:(0,o.createContext)(e$),eq=({children:e,store:t=e$})=>ef?e:o.createElement(eV.Provider,{value:t},e),eU=e=>{let t=(0,o.useContext)(eV);return(0,A.P)(t,(0,O.k)(e))},eG=({collapsedIds:e,nodes:t,edges:n})=>{let r=[],o=[];for(let i of e){let{hiddenEdges:e,hiddenNodes:a}=function e({nodeId:t,nodes:n,edges:r,currentHiddenNodes:o,currentHiddenEdges:i}){let a=[],l=[],s=o.map(e=>e.id),d=i.map(e=>e.id),c=r.filter(e=>e.source===t),u=c.map(e=>e.target);for(let o of(l.push(...c),u)){let i=r.filter(e=>e.target===o&&e.source!==t),c=!1;if(0===i.length?c=!0:i.length>0&&!s.includes(o)&&i.map(e=>e.id).every(e=>d.includes(e))&&(c=!0),c){let t=n.find(e=>e.id===o);t&&a.push(t);let i=e({nodeId:o,nodes:n,edges:r,currentHiddenEdges:l,currentHiddenNodes:a});l.push(...i.hiddenEdges),a.push(...i.hiddenNodes)}}return{hiddenEdges:Object.values(l.reduce((e,t)=>({...e,[t.id]:t}),{})),hiddenNodes:Object.values(a.reduce((e,t)=>({...e,[t.id]:t}),{}))}}({nodeId:i,nodes:t,edges:n,currentHiddenEdges:o,currentHiddenNodes:r});r.push(...a),o.push(...e)}let i=r.map(e=>e.id),a=o.map(e=>e.id);return{visibleNodes:t.filter(e=>!i.includes(e.id)),visibleEdges:n.filter(e=>!a.includes(e.id))}},eK=({nodeId:e,edges:t,visibleEdgeIds:n})=>{let r=[],o=t.filter(t=>t.target===e);if(o.map(e=>e.id).some(e=>n.includes(e)))return r;let i=o.map(e=>e.source),a=!1;for(let e of i)a||(r.push(e,...eK({nodeId:e,edges:t,visibleEdgeIds:n})),a=!0);return r},eQ=({collapsedNodeIds:e=[],nodes:t=[],edges:n=[]})=>({getIsCollapsed:(0,o.useCallback)(r=>{let{visibleNodes:o}=eG({nodes:t,edges:n,collapsedIds:e});return!o.map(e=>e.id).includes(r)},[e,n,t]),getExpandPathIds:(0,o.useCallback)(r=>{let{visibleEdges:o}=eG({nodes:t,edges:n,collapsedIds:e});return eK({nodeId:r,edges:n,visibleEdgeIds:o.map(e=>e.id)})},[e,n,t])}),eH=({layoutType:e,sizingType:t,labelType:n,sizingAttribute:r,clusterAttribute:a,selections:l,nodes:s,edges:d,actives:c,collapsedNodeIds:u,defaultNodeSize:f,maxNodeSize:g,minNodeSize:p,layoutOverrides:h,constrainDragging:m})=>{let y=eU(e=>e.graph),b=eU(e=>e.clusters),v=eU(e=>e.nodes),x=eU(e=>e.setClusters),C=eU(e=>e.collapsedNodeIds),w=eU(e=>e.setEdges),E=eU(e=>e.nodes),k=eU(e=>e.setNodes),z=eU(e=>e.setSelections),M=eU(e=>e.setActives),P=eU(e=>e.drags),A=eU(e=>e.setDrags),O=eU(e=>e.setCollapsedNodeIds),j=(0,o.useRef)(!1),I=(0,o.useRef)(null),S=(0,i.C)(e=>e.camera),N=(0,o.useRef)(P),L=(0,o.useRef)([]);(0,o.useEffect)(()=>{if(!a)return;let e=v.map(e=>e.id),t=s.find(t=>!e.includes(t.id));if(t){let e=t.data[a],n=b.get(e),r={...N.current};n?.nodes?.forEach(e=>r[e.id]=void 0),N.current=r,A(r)}},[v,s,a,b,A]);let{visibleEdges:_,visibleNodes:D}=(0,o.useMemo)(()=>eG({collapsedIds:C,nodes:s,edges:d}),[C,s,d]),R=(0,o.useCallback)(e=>{let t={...N.current};e.forEach(e=>t[e.id]=e),N.current=t,A(t)},[A]),T=(0,o.useCallback)(async o=>{I.current=o||es({...h,type:e,graph:y,drags:N.current,clusters:L?.current,clusterAttribute:a}),await K(I.current);let i=ev({graph:y,layout:I.current,sizingType:t,labelType:n,sizingAttribute:r,maxNodeSize:g,minNodeSize:p,defaultNodeSize:f,clusterAttribute:a}),l=eL({nodes:i.nodes,clusterAttribute:a});m&&l.forEach(e=>{let t=L.current.get(e.label);t?.nodes.length===e.nodes.length&&(e.position=L.current?.get(e.label)?.position??e.position)}),w(i.edges),k(i.nodes),x(l),a&&R(i.nodes)},[h,e,a,t,n,r,g,p,f,w,k,x]);return(0,o.useEffect)(()=>{N.current=P},[P,a,T]),(0,o.useEffect)(()=>{L.current=b},[b]),(0,o.useEffect)(()=>{let e=E.map(e=>({...e,labelVisible:ec({nodeCount:E?.length,labelType:n,camera:S,nodePosition:e?.position})("node",e?.size)}));e.some((e,t)=>e.labelVisible!==E[t].labelVisible)&&k(e)},[S,S.zoom,S.position.z,k,E,n]),(0,o.useEffect)(()=>{j.current&&z(l)},[l,z]),(0,o.useEffect)(()=>{j.current&&M(c)},[c,M]),(0,o.useEffect)(()=>{!async function(){j.current=!1,eb(y,D,_),await T(),requestAnimationFrame(()=>j.current=!0)}()},[D,_]),(0,o.useEffect)(()=>{j.current&&O(u)},[u,O]),(0,o.useEffect)(()=>{j.current&&(N.current={},A({}),T())},[e,T,A]),(0,o.useEffect)(()=>{j.current&&T(I.current)},[t,r,n,T]),{updateLayout:T}},eY=({text:e,fontSize:t=7,fontUrl:n,color:i="#2A6475",opacity:a=1,stroke:s,backgroundColor:d,backgroundOpacity:c=1,padding:u=1,strokeColor:f,strokeWidth:g=0,radius:p=.1,active:h,ellipsis:m=75,rotation:y})=>{let b=m&&!h?$(e,m):e,v=(0,o.useMemo)(()=>new l.Q1f(i),[i]),x=(0,o.useMemo)(()=>s?new l.Q1f(s):void 0,[s]),C=(0,o.useMemo)(()=>d?new l.Q1f(d):null,[d]),w=(0,o.useMemo)(()=>f?new l.Q1f(f):null,[f]),E=Math.min(p*t,3),k={width:b.length*t*.6+2*u,height:1.2*t+2*u};return(0,r.jsxs)(_.Q,{position:[0,0,h?2:1],renderOrder:1,children:[g>0&&w&&C&&(0,r.jsx)("mesh",{position:[0,0,10],children:(0,r.jsx)(D.b,{args:[k.width+g,k.height+g,.1],radius:E,smoothness:8,"material-color":w,"material-transparent":!0,"material-opacity":c})}),C&&(0,r.jsx)("mesh",{position:[0,0,10],children:(0,r.jsx)(D.b,{args:[k.width,k.height,.1],radius:E,smoothness:8,"material-color":C,"material-transparent":!0,"material-opacity":c})}),(0,r.jsx)(R.E,{position:[0,0,11],font:n,fontSize:t,color:v,fillOpacity:a,textAlign:"center",outlineWidth:+!!s,outlineColor:x,depthOffset:0,maxWidth:100,overflowWrap:"break-word",rotation:y,children:b})]})},eW=({draggable:e,set:t,position:n,bounds:r,onDragStart:a,onDragEnd:s})=>{let d=(0,i.C)(e=>e.camera),c=(0,i.C)(e=>e.raycaster),u=(0,i.C)(e=>e.size),f=(0,i.C)(e=>e.gl),{mouse2D:g,mouse3D:p,offset:h,normal:m,plane:y}=(0,o.useMemo)(()=>({mouse2D:new l.I9Y,mouse3D:new l.Pq0,offset:new l.Pq0,normal:new l.Pq0,plane:new l.Zcv}),[]),b=(0,o.useMemo)(()=>f.domElement.getBoundingClientRect(),[f.domElement,u]);return(0,V.useGesture)({onDragStart:({event:e})=>{let{eventObject:t,point:n}=e;t.getWorldPosition(h).sub(n),p.copy(n),a()},onDrag:({xy:e,buttons:o,cancel:i})=>{if(1!==o)return void i();let a=(e[0]-(b?.left??0))/u.width*2-1,s=-(2*((e[1]-(b?.top??0))/u.height))+1;g.set(a,s),c.setFromCamera(g,d),d.getWorldDirection(m).negate(),y.setFromNormalAndCoplanarPoint(m,p),c.ray.intersectPlane(y,p);let f=new l.Pq0(n.x,n.y,n.z).copy(p).add(h);if(r){let e=new l.Pq0((r.minX+r.maxX)/2,(r.minY+r.maxY)/2,(r.minZ+r.maxZ)/2),t=(r.maxX-r.minX)/2,n=f.clone().sub(e);n.length()>t&&(n.normalize().multiplyScalar(t),f.copy(e).add(n))}return t(f)},onDragEnd:s},{drag:{enabled:e,threshold:10}})},eX=({sensitivity:e=7,interval:t=50,timeout:n=0,disabled:r,onPointerOver:i,onPointerOut:a})=>{let l=(0,o.useRef)(!1),s=(0,o.useRef)(null),d=(0,o.useRef)(0),c=(0,o.useRef)({x:null,y:null,px:null,py:null}),u=(0,o.useCallback)(e=>{c.current.x=e.clientX,c.current.y=e.clientY},[]),f=(0,o.useCallback)(n=>{s.current=clearTimeout(s.current);let{px:r,x:o,py:a,y:l}=c.current;Math.abs(r-o)+Math.abs(a-l)<e?(d.current=1,i(n)):(c.current.px=o,c.current.py=l,s.current=setTimeout(()=>f(n),t))},[t,i,e]),g=(0,o.useCallback)(()=>{clearTimeout(s.current),"undefined"!=typeof window&&document.removeEventListener("mousemove",u,!1)},[u]),p=(0,o.useCallback)(e=>{r||(l.current=!0,g(),1!==d.current&&(c.current.px=e.pointer.x,c.current.py=e.pointer.y,"undefined"!=typeof window&&document.addEventListener("mousemove",u,!1),s.current=setTimeout(()=>f(e),n)))},[g,f,r,u,n]),h=(0,o.useCallback)(e=>{s.current=clearTimeout(s.current),d.current=0,a(e)},[a]);return{pointerOver:p,pointerOut:(0,o.useCallback)(e=>{l.current=!1,g(),1===d.current&&(s.current=setTimeout(()=>h(e),n))},[g,h,n])}},eZ=(0,o.createContext)({controls:null,resetControls:()=>void 0,zoomIn:()=>void 0,zoomOut:()=>void 0,dollyIn:()=>void 0,dollyOut:()=>void 0,panLeft:()=>void 0,panRight:()=>void 0,panUp:()=>void 0,panDown:()=>void 0,freeze:()=>void 0,unFreeze:()=>void 0}),eJ=()=>{let e=(0,o.useContext)(eZ);if(void 0===e)throw Error("`useCameraControls` hook must be used within a `ControlsProvider` component");return e},e0=({outerRadius:e,innerRadius:t,padding:n,normalizedFill:o,normalizedStroke:i,opacity:a,animated:s,theme:d})=>{let{opacity:c}=(0,L.zh)({from:{opacity:0},to:{opacity:a},config:{...ex,duration:s?void 0:0}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("mesh",{children:[(0,r.jsx)("ringGeometry",{attach:"geometry",args:[e,0,128]}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",color:o,transparent:!0,depthTest:!1,opacity:d.cluster?.fill?c:0,side:l.$EB,fog:!0})]}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("ringGeometry",{attach:"geometry",args:[e,t+n,128]}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",color:i,transparent:!0,depthTest:!1,opacity:c,side:l.$EB,fog:!0})]})]})},e1=({animated:e,position:t,padding:n=40,labelFontUrl:i,disabled:a,radius:s=2,nodes:d,label:c,onClick:u,onPointerOver:f,onPointerOut:g,draggable:p=!1,onDragged:h,onRender:m})=>{let y=eU(e=>e.theme),b=Math.max(t.width,t.height)/2,v=b-s+n,[x,C]=(0,o.useState)(!1),w=eU(e=>e.centerPosition),E=eU(e=>e.nodes),k=eJ(),z=eU(e=>e.draggingIds),M=z.includes(c),P=z.length>0,A=eU(e=>e.actives?.some(e=>d.some(t=>t.id===e))),O=eU(e=>e.hoveredNodeId),j=eU(e=>e.selections?.some(e=>d.some(t=>t.id===e))),I=eU(e=>e.selections?.length>0)?j||x||A?y.cluster?.selectedOpacity:y.cluster?.inactiveOpacity:y.cluster?.opacity,S=(0,o.useMemo)(()=>{let e=[0,-v,2],t=y.cluster?.label?.offset;return t?[e[0]-t[0],e[1]-t[1],e[2]-t[2]]:e},[v,y.cluster?.label?.offset]),{circlePosition:N}=(0,L.zh)({from:{circlePosition:[w.x,w.y,-1]},to:{circlePosition:t?[t.x,t.y,-1]:[0,0,-1]},config:{...ex,duration:e&&!P?void 0:0}}),_=(0,o.useMemo)(()=>new l.Q1f(y.cluster?.stroke),[y.cluster?.stroke]),D=(0,o.useMemo)(()=>new l.Q1f(y.cluster?.fill),[y.cluster?.fill]),R=eU(e=>e.addDraggingId),B=eU(e=>e.removeDraggingId),F=eU(e=>e.setClusterPosition),$=eW({draggable:p&&!O,position:{x:t.x,y:t.y,z:-1},set:e=>F(c,e),onDragStart:()=>{R(c),C(!0)},onDragEnd:()=>{B(c),C(!1);let e=E.filter(e=>e.cluster===c);h?.({nodes:e,label:c})}});(0,T.o)(x&&!P&&void 0!==u,"pointer"),(0,T.o)(x&&p&&!M&&void 0===u,"grab"),(0,T.o)(M,"grabbing");let{pointerOver:V,pointerOut:q}=eX({disabled:a,onPointerOver:e=>{C(!0),k.freeze(),f?.({nodes:d,label:c},e)},onPointerOut:e=>{C(!1),k.unFreeze(),g?.({nodes:d,label:c},e)}});return(0,o.useMemo)(()=>y.cluster&&(0,r.jsx)(L.a.group,{userData:{id:c,type:"cluster"},position:N,onPointerOver:V,onPointerOut:q,onClick:e=>{a||M||u?.({nodes:d,label:c},e)},...$(),children:m?m({label:{position:S,text:c,opacity:I,fontUrl:i},opacity:I,outerRadius:v,innerRadius:b,padding:n,theme:y}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e0,{outerRadius:v,innerRadius:b,padding:n,normalizedFill:D,normalizedStroke:_,opacity:I,animated:e,theme:y}),y.cluster?.label&&(0,r.jsx)(L.a.group,{position:S,children:(0,r.jsx)(eY,{text:c,opacity:I,fontUrl:i,stroke:y.cluster.label.stroke,active:!1,color:y.cluster?.label.color,fontSize:y.cluster?.label.fontSize??12})})]})}),[y,N,V,q,v,D,b,n,_,S,c,I,i,a,u,d,$,M,m,e])},e5=({animated:e,color:t="#D8E6EA",length:n,opacity:i=.5,position:a,rotation:s,size:d=1,onActive:c,onContextMenu:u})=>{let f=(0,o.useMemo)(()=>new l.Q1f(t),[t]),g=(0,o.useRef)(null),p=eU(e=>e.draggingIds.length>0),h=eU(e=>e.centerPosition),[{pos:m,arrowOpacity:y}]=(0,L.zh)(()=>({from:{pos:h?[h.x,h.y,h.z]:[0,0,0],arrowOpacity:0},to:{pos:[a.x,a.y,a.z],arrowOpacity:i},config:{...ex,duration:e&&!p?void 0:0}}),[e,p,i,a]),b=(0,o.useCallback)(()=>{let e=new l.Pq0(0,1,0);g.current?.quaternion.setFromUnitVectors(e,s)},[s,g]);return(0,o.useEffect)(()=>b(),[b]),(0,r.jsxs)(L.a.mesh,{position:m,ref:g,scale:[1,1,1],onPointerOver:()=>c(!0),onPointerOut:()=>c(!1),onPointerDown:e=>{2===e.nativeEvent.buttons&&e.stopPropagation()},onContextMenu:e=>{e.nativeEvent.preventDefault(),e.stopPropagation(),u()},children:[(0,r.jsx)("cylinderGeometry",{args:[0,d,n,20,1,!0],attach:"geometry"}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",color:f,depthTest:!1,opacity:y,transparent:!0,side:l.$EB,fog:!0})]})},e2=`
  varying vec2 vUv;
  void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
  }
`,e3=`
  uniform vec3 color;
  uniform float opacity;
  uniform float dashSize;
  uniform float gapSize;
  uniform float lineLength;
  varying vec2 vUv;

  void main() {
    float totalSize = dashSize + gapSize;
    float position = mod(vUv.x * lineLength, totalSize);

    if (position > dashSize) {
      discard;
    }

    gl_FragColor = vec4(color, opacity);
  }
`,e7=({curveOffset:e,animated:t,color:n="#000",curve:i,curved:a=!1,dashed:s=!1,dashArray:d=[3,1],id:c,opacity:u=1,size:f=1,onContextMenu:g,onClick:p,onPointerOver:h,onPointerOut:m})=>{let y=(0,o.useRef)(null),b=eU(e=>e.draggingIds.length>0),v=(0,o.useMemo)(()=>new l.Q1f(n),[n]),x=eU(e=>e.centerPosition),C=(0,o.useRef)(!1),w=(0,o.useMemo)(()=>{if(!s)return null;let[e,t]=d;return new l.BKk({uniforms:{color:{value:v},opacity:{value:u},dashSize:{value:e},gapSize:{value:t},lineLength:{value:i.getLength()}},vertexShader:e2,fragmentShader:e3,transparent:!0,depthTest:!1})},[s,v,u,i,d]),{lineOpacity:E}=(0,L.zh)({from:{lineOpacity:0},to:{lineOpacity:u},config:{...ex,duration:t?void 0:0}});return(0,L.zh)(()=>{let n=i.getPoint(0),r=i.getPoint(1);return{from:{fromVertices:C.current?[r?.x,r?.y,r?.z||0]:[x?.x,x?.y,x?.z||0],toVertices:[n?.x,n?.y,n?.z||0]},to:{fromVertices:[n?.x,n?.y,n?.z||0],toVertices:[r?.x,r?.y,r?.z||0]},onChange:t=>{let{fromVertices:n,toVertices:r}=t.value,o=ez(new l.Pq0(...n),0,new l.Pq0(...r),0,a,e);if(y.current){let e=s?.4*f:f/2;y.current.copy(new l.j6(o,20,e,5,!1))}},config:{...ex,duration:t&&!b?void 0:0}}},[t,b,i,f,s,a,e]),(0,o.useEffect)(()=>{C.current=!0},[]),(0,r.jsxs)("mesh",{userData:{id:c,type:"edge"},renderOrder:-1,onPointerOver:h,onPointerOut:m,onClick:p,onPointerDown:e=>{2===e.nativeEvent.buttons&&e.stopPropagation()},onContextMenu:e=>{e.nativeEvent.preventDefault(),e.stopPropagation(),g()},children:[(0,r.jsx)("tubeGeometry",{attach:"geometry",ref:y}),s?(0,r.jsx)("primitive",{attach:"material",object:w}):(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",opacity:E,fog:!0,transparent:!0,depthTest:!1,color:v})]})},e9=({id:e,curve:t,opacity:n=1,size:i=1,color:a="#000",animated:s,onPointerOver:d,onPointerOut:c,onClick:u,onContextMenu:f})=>{let{scale:g,loopOpacity:p}=(0,L.zh)({from:{scale:[1e-5,1e-5,1e-5],loopOpacity:0},to:{scale:[i,i,i],loopOpacity:n},config:{...ex,duration:s?void 0:0}}),h=(0,o.useMemo)(()=>new l.Q1f(a),[a]);return(0,r.jsxs)(L.a.mesh,{userData:{id:e,type:"edge"},renderOrder:-1,onPointerOver:d,onPointerOut:c,onClick:u,onPointerDown:e=>{2===e.nativeEvent.buttons&&(e.nativeEvent.preventDefault(),e.stopPropagation(),f())},scale:g,children:[(0,r.jsx)("tubeGeometry",{attach:"geometry",args:[t,128,i/2,8,!0]}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",opacity:p,fog:!0,transparent:!0,depthTest:!1,color:h})]})},e6=({animated:e,arrowPlacement:t="end",contextMenu:n,disabled:i,labelPlacement:a="inline",id:s,interpolation:d,labelFontUrl:c,onContextMenu:u,onClick:f,onPointerOver:g,onPointerOut:p,subLabelPlacement:h="below"})=>{let m=eU(e=>e.theme),y=eU(e=>e.draggingIds.length>0),[b,v]=(0,o.useState)(!1),[x,C]=(0,o.useState)(!1),w=eU(e=>e.edges),E=w.find(e=>e.id===s),{target:k,source:z,label:M,subLabel:P,labelVisible:A=!1,size:O=1,fill:j,dashed:I=!1,dashArray:S=[3,1]}=E,N=E.subLabelPlacement||h,_=eU(e=>e.nodes.find(e=>e.id===z)),D=eU(e=>e.nodes.find(e=>e.id===k)),R=_.id===D.id,F=(O+m.edge.label.fontSize)/2,[$,V]=(0,o.useMemo)(()=>ew(O),[O]),q=E.interpolation||d,U=E.arrowPlacement||t,{curveOffset:G,curved:K}=(0,o.useMemo)(()=>ej({edge:E,edges:w,curved:"curved"===q}),[E,w,q]),[Q,H,Y]=(0,o.useMemo)(()=>{let e=eP(_),t=_.size,n=ez(e,t,eP(D),D.size,K,G),[r,o]=eC(U,n,$);return"end"===U&&(n=ez(e,t,r,0,K,G)),[n,r,o]},[_,D,K,G,U,$]),W=(0,o.useMemo)(()=>{let e=eE(_.position,D.position,eu(F,a));if(K){let t=new l.Pq0().subVectors(e,Q.getPoint(.5));switch(a){case"above":t.y=t.y-3;break;case"below":t.y=t.y+3}e=e.sub(t)}return e},[_.position,D.position,F,a,K,Q]),X=eU(e=>e.selections?.includes(s)),Z=eU(e=>e.selections?.length),J=eU(e=>e.actives?.includes(s)),ee=eU(e=>e.centerPosition),et=Z?X||J?m.edge.selectedOpacity:m.edge.inactiveOpacity:m.edge.opacity,en=(0,o.useMemo)(()=>eI(_.position,D.position,N),[_.position,D.position,N]),[{labelPosition:er}]=(0,L.zh)(()=>({from:{labelPosition:ee?[ee.x,ee.y,ee.z]:[0,0,0]},to:{labelPosition:[W.x,W.y,W.z]},config:{...ex,duration:e&&!y?void 0:0}}),[W,e,y]),eo=(0,o.useMemo)(()=>new l.O9p(0,0,"natural"===a?0:Math.atan((D.position.y-_.position.y)/(D.position.x-_.position.x))),[D.position.x,D.position.y,_.position.x,_.position.y,a]);(0,T.o)(b&&!y&&void 0!==f,"pointer");let{pointerOver:ei,pointerOut:ea}=eX({disabled:i,onPointerOver:e=>{v(!0),g?.(E,e)},onPointerOut:e=>{v(!1),p?.(E,e)}}),el=(0,o.useMemo)(()=>eM(_),[_]),es=(0,o.useMemo)(()=>{let t,n;return"none"===U?null:(R&&el?"mid"===U?(t=el.getPointAt(.25),n=el.getTangentAt(.25)):(t=el.getPointAt(.58),n=el.getTangentAt(.58)):(t=H,n=Y),(0,r.jsx)(e5,{animated:e,color:X||b||J?m.arrow.activeFill:j||m.arrow.fill,length:$,opacity:et,position:t,rotation:n,size:V,onActive:v,onContextMenu:()=>{i||(C(!0),u?.(E))}}))},[j,b,e,$,U,H,Y,V,i,E,J,X,u,et,m.arrow.activeFill,m.arrow.fill,R,el]),ed=(0,o.useMemo)(()=>A&&M&&(0,r.jsxs)(L.a.group,{position:er,onContextMenu:()=>{i||(C(!0),u?.(E))},onPointerOver:ei,onPointerOut:ea,children:[(0,r.jsx)(eY,{text:M,ellipsis:15,fontUrl:c,stroke:m.edge.label.stroke,color:X||b||J?m.edge.label.activeColor:m.edge.label.color,opacity:et,fontSize:m.edge.label.fontSize,rotation:eo,active:X||b||J}),P&&(0,r.jsx)("group",{position:[en.x,en.y,0],children:(0,r.jsx)(eY,{text:P,ellipsis:15,fontUrl:c,stroke:m.edge.subLabel?.stroke||m.edge.label.stroke,active:X||b||J,color:X||b||J?m.edge.subLabel?.activeColor||m.edge.label.activeColor:m.edge.subLabel?.color||m.edge.label.color,opacity:et,fontSize:m.edge.subLabel?.fontSize||.8*m.edge.label.fontSize,rotation:eo})})]}),[b,i,E,J,X,M,P,c,er,en,eo,A,u,ea,ei,et,m.edge.label.activeColor,m.edge.label.color,m.edge.label.fontSize,m.edge.label.stroke,m.edge.subLabel?.stroke,m.edge.subLabel?.activeColor,m.edge.subLabel?.color,m.edge.subLabel?.fontSize]),ec=(0,o.useMemo)(()=>x&&n&&(0,r.jsx)(B.E,{prepend:!0,center:!0,position:W,children:n({data:E,onClose:()=>C(!1)})}),[x,n,W,E]);return(0,r.jsxs)("group",{children:[R&&el?(0,r.jsx)(e9,{id:s,curve:el,size:O,animated:e,color:X||b||J?m.edge.activeFill:j||m.edge.fill,opacity:et,onClick:e=>{i||f?.(E,e)},onContextMenu:()=>{i||(C(!0),u?.(E))},onPointerOver:ei,onPointerOut:ea}):(0,r.jsx)(e7,{curveOffset:G,animated:e,color:X||b||J?m.edge.activeFill:j||m.edge.fill,curve:Q,curved:K,dashed:I,dashArray:S,id:s,opacity:et,size:O,onClick:e=>{i||f?.(E,e)},onPointerOver:ei,onPointerOut:ea,onContextMenu:()=>{i||(C(!0),u?.(E))}}),es,ed,ec]})},e4=eR(),e8=({animated:e,color:t,contextMenu:n,edge:i,labelFontUrl:a,labelPlacement:s="inline",opacity:d,active:c})=>{let u=eU(e=>e.theme),{target:f,source:g,label:p,labelVisible:h=!1,size:m=1}=i,y=eU(e=>e.nodes),[b,v]=(0,o.useMemo)(()=>[y.find(e=>e.id===g),y.find(e=>e.id===f)],[y,g,f]),x=eU(e=>e.draggingIds.length>0),C=(0,o.useMemo)(()=>(m+u.edge.label.fontSize)/2,[m,u.edge.label.fontSize]),w=(0,o.useMemo)(()=>eE(b.position,v.position,eu(C,s)),[b.position,v.position,C,s]),E=eU(e=>e.edgeContextMenus),k=eU(e=>e.setEdgeContextMenus),[{labelPosition:z}]=(0,L.zh)(()=>({from:{labelPosition:[0,0,0]},to:{labelPosition:[w.x,w.y,w.z]},config:{...ex,duration:e&&!x?void 0:0}}),[w,e,x]),M=(0,o.useCallback)(e=>{let t=new Set(E);t.delete(e),k(t)},[E,k]),P=(0,o.useMemo)(()=>new l.O9p(0,0,"natural"===s?0:Math.atan((v.position.y-b.position.y)/(v.position.x-b.position.x))),[v.position.x,v.position.y,b.position.x,b.position.y,s]),A=(0,o.useMemo)(()=>({prepend:!0,center:!0,position:w}),[w]),O=(0,o.useMemo)(()=>({text:p,ellipsis:15,fontUrl:a,stroke:u.edge.label.stroke,color:t,opacity:d,fontSize:u.edge.label.fontSize,rotation:P,active:c}),[p,a,u.edge.label.stroke,t,d,u.edge.label.fontSize,P,c]);return(0,r.jsxs)("group",{children:[h&&p&&(0,r.jsx)(L.a.group,{position:z,children:(0,r.jsx)(eY,{...O})}),n&&E.has(i.id)&&(0,r.jsx)(B.E,{...A,children:n({data:i,onClose:()=>M(i.id)})})]})},te=({interpolation:e="linear",arrowPlacement:t="end",labelPlacement:n="inline",animated:a,contextMenu:s,disabled:d,edges:c,labelFontUrl:u,onClick:f,onContextMenu:g,onPointerOut:p,onPointerOver:h})=>{let m=eU(e=>e.theme),{getGeometries:y,getGeometry:b}=function(e,t){let n=(0,o.useRef)(null),r=eU(e=>e.theme);eU(e=>{n.current=e});let i=(0,o.useRef)(new Map),a=(0,o.useRef)(null),s=(0,o.useCallback)(o=>{let s=[],d=i.current,{nodes:c}=n.current,u=new Map(c.map(e=>[e.id,e]));return"none"===e||a.current||(a.current=new l.Ho_(0,1,1,20,1,!0)),o.forEach(n=>{let o,i,c,f,{target:g,source:p,size:h=1}=n,m=u.get(p),y=u.get(g);if(!m||!y)return;let b=`${m.position.x},${m.position.y},${y.position.x},${y.position.y},${h}`,v=m.id===y.id,x="curved"===(n.interpolation||t),C=n.arrowPlacement||e;if(d.has(b))return void s.push(d.get(b));let w=eP(m),E=m.size,k=eP(y),z=y.size;o=v?eM(m):ez(w,E,k,z,x);let M=n.dashed,P=M?.4*h:h/2;if(i=M?eB(o,P,new l.Q1f(n.fill??r.edge.fill),n.dashArray):new l.j6(o,20,P,5,!1),"none"===C){M||eT(i,new l.Q1f(n.fill??r.edge.fill)),s.push(i),d.set(b,i);return}let[A,O]=ew(h),j=a.current.clone();j.scale(O,A,O),v?"mid"===C?(c=o.getPointAt(.25),f=o.getTangentAt(.25)):(c=o.getPointAt(.58),f=o.getTangentAt(.58)):[c,f]=eC(C,o,A);let S=new l.PTz;if(S.setFromUnitVectors(new l.Pq0(0,1,0),f),j.applyQuaternion(S),j.translate(c.x,c.y,c.z),C&&"end"===C&&!v){let e=ez(w,E,c,0,x);i=M?eB(e,P,new l.Q1f(n.fill??r.edge.fill),n.dashArray):new l.j6(e,20,P,5,!1)}let N=new l.Q1f(n.fill??r.edge.fill);M||eT(i,N),eT(j,N);let L=(0,I.h0)([i,j]);L.userData={...L.userData,type:"edge"},s.push(L),d.set(b,L)}),s},[e,t,r.edge.fill]),d=(0,o.useCallback)((e,t)=>{let n=s(e),r=s(t);return(0,I.h0)([r.length?(0,I.h0)(r):e4,n.length?(0,I.h0)(n):e4],!0)},[s]);return{getGeometries:s,getGeometry:d}}(t,e),v=eU(e=>e.draggingIds),x=eU(e=>e.edgeMeshes),C=eU(e=>e.setEdgeMeshes),w=eU(e=>e.actives||[]),E=eU(e=>e.selections||[]),k=eU(e=>e.hoveredEdgeIds||[]),[z,M,P,A]=(0,o.useMemo)(()=>{let e=[],t=[],n=[],r=[];return c.forEach(o=>{if(v.includes(o.source)||v.includes(o.target))return void(E.includes(o.id)||w.includes(o.id)||k.includes(o.id)?n.push(o):r.push(o));E.includes(o.id)||w.includes(o.id)||k.includes(o.id)?e.push(o):t.push(o)}),[e,t,n,r]},[c,w,E,v,k]),O=!!E.length,j=(0,o.useMemo)(()=>b(z,M),[b,z,M]),{activeOpacity:S,inactiveOpacity:N}=function(e,t,n){let[{activeOpacity:r,inactiveOpacity:o}]=(0,L.zh)(()=>({from:{activeOpacity:0,inactiveOpacity:0},to:{activeOpacity:t?n.edge.selectedOpacity:n.edge.opacity,inactiveOpacity:t?n.edge.inactiveOpacity:n.edge.opacity},config:{...ex,duration:e?void 0:0}}),[e,t,n]);return{activeOpacity:r,inactiveOpacity:o}}(a,O,m);!function(e,t){let n=(0,o.useRef)(e),r=(0,o.useRef)(null);(0,o.useEffect)(()=>{n.current=e,r.current=new Float32Array(e.getAttribute("position").array.length)},[e]);let i=(0,o.useCallback)(()=>{let e=n.current.getAttribute("position");return{from:new Float32Array(e.array.length),to:e.array}},[]),a=(0,o.useCallback)(e=>{let t=r.current;t.set(e);let o=new l.THS(t,3,!1);n.current.setAttribute("position",o),o.needsUpdate=!0},[]);(0,L.zh)(()=>{if(!t)return null;let e=i();return{from:{positions:e.from},to:{positions:e.to},onChange:e=>{a(e.value.positions)},config:{...ex,duration:t?void 0:0}}},[t,i,a])}(j,a),(0,o.useEffect)(()=>{0===v.length&&C(y(c).map(e=>new l.eaF(e)))},[y,C,c,v.length]);let _=(0,o.useRef)(new l.eaF),D=(0,o.useRef)(new l.eaF),R=(0,o.useCallback)(e=>{if(!e.camera)return[];let t=e.intersectObjects(x);return t.length?t.map(e=>c[x.indexOf(e.object)]):[]},[x,c]),{handleClick:T,handleContextMenu:B,handleIntersections:F}=function(e,t,n){let r=(0,o.useRef)(e);(0,o.useEffect)(()=>{r.current=e},[e]);let i=eU(e=>e.edgeContextMenus),a=eU((0,o.useCallback)(e=>e.setEdgeContextMenus,[])),l=eU((0,o.useCallback)(e=>e.setHoveredEdgeIds,[])),s=(0,o.useRef)(!1),d=(0,o.useCallback)(()=>{s.current=!0},[]),c=(0,o.useRef)(!1);return{handleClick:d,handleContextMenu:(0,o.useCallback)(()=>{c.current=!0},[]),handleIntersections:(0,o.useCallback)((e,o)=>{let{onClick:d,onContextMenu:u,onPointerOver:f,onPointerOut:g}=r.current;if(d&&s.current&&!n)for(let e of(s.current=!1,o))d(e);if((t||u)&&c.current&&!n){c.current=!1;let e=new Set(i),t=!1;for(let n of o)i.has(n.id)||(e.add(n.id),t=!0,u?.(n));t&&a(e)}l(o.length>0?o.map(e=>e.id):[]),f&&o.filter(t=>!e.includes(t)).forEach(e=>{f(e)}),g&&e.filter(e=>!o.includes(e)).forEach(e=>{g(e)})},[t,n,i,a,l])}}({onClick:f,onContextMenu:g,onPointerOut:p,onPointerOver:h},s,d),$=(0,o.useRef)([]),V=(0,o.useRef)([]);return(0,i.D)(e=>{if(_.current.geometry=j,d)return;let t=$.current;if((v.length||0===v.length&&null!==t)&&(D.current.geometry=b(P,A)),$.current=v,v.length)return;let n=V.current,r=R(e.raycaster);F(n,r),r.join()!==n.join()&&(D.current.geometry=b(r,[])),V.current=r}),(0,r.jsxs)("group",{onClick:T,onContextMenu:B,children:[(0,r.jsxs)("mesh",{ref:_,children:[(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material-0",depthTest:!1,fog:!0,opacity:N,side:l.$EB,transparent:!0,vertexColors:!0}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material-1",color:m.edge.activeFill,depthTest:!1,fog:!0,opacity:S,side:l.$EB,transparent:!0})]}),(0,r.jsxs)("mesh",{ref:D,children:[(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material-0",color:m.edge.fill,depthTest:!1,fog:!0,opacity:N,side:l.$EB,transparent:!0}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material-1",color:m.edge.activeFill,depthTest:!1,fog:!0,opacity:S,side:l.$EB,transparent:!0})]}),c.map(e=>{let t=E.includes(e.id),o=w.includes(e.id),i=k.includes(e.id);return(0,r.jsx)(e8,{animated:a,contextMenu:s,color:t||o||i?m.edge.label.activeColor:m.edge.label.color,disabled:d,edge:e,labelFontUrl:u,labelPlacement:n,active:t||o||i},e.id)})]})},tt=({color:e="#D8E6EA",size:t=1,opacity:n=.5,animated:i,strokeWidth:a=5,innerRadius:s=4,segments:d=25})=>{let c=(0,o.useMemo)(()=>new l.Q1f(e),[e]),{ringSize:u,ringOpacity:f}=(0,L.zh)({from:{ringOpacity:0,ringSize:[1e-5,1e-5,1e-5]},to:{ringOpacity:n,ringSize:[t/2,t/2,1]},config:{...ex,duration:i?void 0:0}});return(0,r.jsx)(_.Q,{position:[0,0,1],children:(0,r.jsxs)(L.a.mesh,{scale:u,raycast:n>0?void 0:()=>[],children:[(0,r.jsx)("ringGeometry",{attach:"geometry",args:[s,s+a/10,d]}),(0,r.jsx)(L.a.meshBasicMaterial,{attach:"material",color:c,transparent:!0,depthTest:!1,opacity:f,side:l.$EB,fog:!0})]})})},tn=({color:e,id:t,size:n,selected:i,opacity:a=1,animated:s})=>{let{scale:d,nodeOpacity:c}=(0,L.zh)({from:{scale:[1e-5,1e-5,1e-5],nodeOpacity:0},to:{scale:[n,n,n],nodeOpacity:a},config:{...ex,duration:s?void 0:0}}),u=(0,o.useMemo)(()=>new l.Q1f(e),[e]),f=eU(e=>e.theme);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(L.a.mesh,{userData:{id:t,type:"node"},scale:d,children:[(0,r.jsx)("sphereGeometry",{attach:"geometry",args:[1,25,25]}),(0,r.jsx)(L.a.meshPhongMaterial,{attach:"material",side:l.$EB,transparent:!0,fog:!0,opacity:c,color:u,emissive:u,emissiveIntensity:.7})]}),(0,r.jsx)(tt,{opacity:.5*!!i,size:n,animated:s,color:i?f.ring.activeFill:f.ring.fill})]})},tr=({image:e,id:t,size:n,opacity:i=1,animated:a})=>{let s=(0,o.useMemo)(()=>new l.Tap().load(e),[e]),{scale:d,spriteOpacity:c}=(0,L.zh)({from:{scale:[1e-5,1e-5,1e-5],spriteOpacity:0},to:{scale:[n,n,n],spriteOpacity:i},config:{...ex,duration:a?void 0:0}});return(0,r.jsx)(L.a.sprite,{userData:{id:t,type:"node"},scale:d,children:(0,r.jsx)(L.a.spriteMaterial,{attach:"material",opacity:c,fog:!0,depthTest:!1,transparent:!0,side:l.$EB,children:(0,r.jsx)("primitive",{attach:"map",object:s,minFilter:l.k6q})})})},to=({color:e,id:t,size:n,opacity:o=1,node:i,active:a=!1,animated:l,image:s,selected:d})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tn,{id:t,selected:d,size:n,opacity:o,animated:l,color:e,node:i,active:a}),(0,r.jsx)(tr,{id:t,image:s,selected:d,size:n+8,opacity:o,animated:l,color:e,node:i,active:a})]}),ti=({id:e,image:t,color:n,size:i,opacity:a=1,animated:s,...d})=>{let c=i/25,{scale:u}=(0,L.zh)({from:{scale:[1e-5,1e-5,1e-5]},to:{scale:[c,c,c]},config:{...ex,duration:s?void 0:0}}),f=(0,o.useMemo)(()=>new l.Q1f(n),[n]);return(0,r.jsx)(L.a.group,{userData:{id:e,type:"node"},scale:u,children:(0,r.jsx)(_.Q,{position:[0,0,1],children:(0,r.jsx)(F.B,{...d,src:t,fillMaterial:{fog:!0,depthTest:!1,transparent:!0,color:f,opacity:a,side:l.$EB,...d.fillMaterial||{}},fillMeshProps:{position:[-25,-25,1],...d.fillMeshProps||{}}})})})},ta=({color:e,id:t,size:n,opacity:o=1,node:i,svgFill:a,active:l=!1,animated:s,image:d,selected:c,...u})=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tn,{id:t,selected:c,size:n,opacity:o,animated:s,color:e,node:i,active:l}),(0,r.jsx)(ti,{...u,id:t,selected:c,image:d,size:n,opacity:o,animated:s,color:a,node:i,active:l})]}),tl=({label:e,size:t,opacity:n=1,animated:i,backgroundColor:a="#ffffff",textColor:s="#000000",strokeColor:d,strokeWidth:c=0,radius:u=.12,badgeSize:f=1.5,position:g="top-right",padding:p=.3})=>{let h=(0,o.useMemo)(()=>new l.Q1f(a),[a]),m=(0,o.useMemo)(()=>new l.Q1f(s),[s]),y=(0,o.useMemo)(()=>d?new l.Q1f(d):null,[d]),b=Math.min(u,.2),v=(0,o.useMemo)(()=>{if(Array.isArray(g))return g;let e=.65*t;switch(g){case"top-right":default:return[e,e,11];case"top-left":return[-e,e,11];case"bottom-right":return[e,-e,11];case"bottom-left":return[-e,-e,11];case"center":return[0,0,11]}},[g,t]),x=(0,o.useMemo)(()=>{let t=e.length;return{width:Math.max(.5,Math.min(.15*t+p,2+p)),height:Math.max(.5,Math.min(.05*t+.5*p,.8+.5*p))}},[e,p]),{scale:C,badgeOpacity:w}=(0,L.zh)({from:{scale:[1e-5,1e-5,1e-5],badgeOpacity:0},to:{scale:[t*f,t*f,t*f],badgeOpacity:n},config:{...ex,duration:i?void 0:0}});return(0,r.jsx)(_.Q,{position:v,children:(0,r.jsxs)(L.a.group,{scale:C,renderOrder:2,children:[c>0&&y&&(0,r.jsx)(L.a.mesh,{position:[0,0,.9],children:(0,r.jsx)(D.b,{args:[x.width+c,x.height+c,.01],radius:b,smoothness:8,"material-color":y,"material-transparent":!0})}),(0,r.jsx)(L.a.mesh,{position:[0,0,1],children:(0,r.jsx)(D.b,{args:[x.width,x.height,.01],radius:b,smoothness:8,"material-color":h,"material-transparent":!0})}),(0,r.jsx)(R.E,{position:[0,0,1.1],fontSize:.3,color:m,anchorX:"center",anchorY:"middle",maxWidth:x.width-.2,textAlign:"center","material-depthTest":!1,"material-depthWrite":!1,children:e})]})})},ts=({animated:e,disabled:t,id:n,draggable:i=!1,labelFontUrl:a,contextMenu:l,onClick:s,onDoubleClick:d,onPointerOver:c,onDragged:u,onPointerOut:f,onContextMenu:g,renderNode:p,constrainDragging:h})=>{let m=eJ(),y=eU(e=>e.theme),b=eU(e=>e.nodes.find(e=>e.id===n)),v=eU(e=>e.edges),x=eU(e=>e.draggingIds),C=eU(e=>e.collapsedNodeIds),w=eU(e=>e.addDraggingId),E=eU(e=>e.removeDraggingId),k=eU(e=>e.setHoveredNodeId),z=eU(e=>e.setNodePosition),M=eU(e=>e.setCollapsedNodeIds),P=eU(e=>e.collapsedNodeIds.includes(n)),A=eU(e=>e.actives?.includes(n)),O=eU(e=>e.selections?.includes(n)),j=eU(e=>e.selections?.length>0),I=eU(e=>e.centerPosition),S=eU(e=>e.clusters.get(b.cluster)),N=x.includes(n),_=x.length>0,{position:D,label:R,subLabel:F,size:$=7,labelVisible:V=!0}=b,q=(0,o.useRef)(null),[U,G]=(0,o.useState)(!1),[K,Q]=(0,o.useState)(!1),H=U||O||A,Y=j?H?y.node.selectedOpacity:y.node.inactiveOpacity:y.node.opacity,W=(0,o.useMemo)(()=>v.filter(e=>e.source===n).length>0||P,[v,n,P]),X=(0,o.useCallback)(()=>{W&&(P?M(C.filter(e=>e!==n)):M([...C,n]))},[W,C,n,P,M]),[{nodePosition:Z,labelPosition:J}]=(0,L.zh)(()=>({from:{nodePosition:I?[I.x,I.y,0]:[0,0,0],labelPosition:[0,-($+7),2]},to:{nodePosition:D?[D.x,D.y,H?D.z+1:D.z]:[0,0,0],labelPosition:[0,-($+7),2]},config:{...ex,duration:e&&!_?void 0:0}}),[N,D,e,$,H]),ee=eW({draggable:i,position:D,bounds:h?S?.position:void 0,set:e=>z(n,e),onDragStart:()=>{w(n),G(!0)},onDragEnd:()=>{E(n),u?.(b)}});(0,T.o)(U&&!_&&void 0!==s,"pointer"),(0,T.o)(U&&i&&!N&&void 0===s,"grab"),(0,T.o)(N,"grabbing");let et=H||N,en=et?y.node.activeFill:b.fill||y.node.fill,{pointerOver:er,pointerOut:eo}=eX({disabled:t||N,onPointerOver:e=>{m.freeze(),G(!0),c?.(b,e),k(n)},onPointerOut:e=>{m.unFreeze(),G(!1),f?.(b,e),k(null)}}),ei=(0,o.useMemo)(()=>p?p({id:n,color:en,size:$,active:et,opacity:Y,animated:e,selected:O,node:b}):(0,r.jsx)(r.Fragment,{children:b.icon?(0,r.jsx)(tr,{id:n,image:b.icon||"",size:$+8,opacity:Y,animated:e,color:en,node:b,active:et,selected:O}):(0,r.jsx)(tn,{id:n,size:$,opacity:Y,animated:e,color:en,node:b,active:et,selected:O})}),[p,n,en,$,et,Y,e,O,b]),ea=(0,o.useMemo)(()=>V&&(V||O||U)&&R&&(0,r.jsxs)(L.a.group,{position:J,children:[(0,r.jsx)(eY,{text:R,fontUrl:a,opacity:Y,stroke:y.node.label.stroke,backgroundColor:y.node.label.backgroundColor,backgroundOpacity:y.node.label.backgroundOpacity,padding:y.node.label.padding,strokeColor:y.node.label.strokeColor,strokeWidth:y.node.label.strokeWidth,radius:y.node.label.radius,active:O||U||N||A,color:O||U||N||A?y.node.label.activeColor:y.node.label.color}),F&&(0,r.jsx)("group",{position:[0,-($-3),0],children:(0,r.jsx)(eY,{text:F,fontUrl:a,fontSize:5,opacity:Y,stroke:y.node.subLabel?.stroke,active:O||U||N||A,color:O||U||N||A?y.node.subLabel?.activeColor:y.node.subLabel?.color})})]}),[U,A,N,O,R,a,J,V,$,Y,F,y.node.label.activeColor,y.node.label.color,y.node.label.stroke,y.node.label.backgroundColor,y.node.label.backgroundOpacity,y.node.label.padding,y.node.label.strokeColor,y.node.label.strokeWidth,y.node.label.radius,y.node.subLabel?.activeColor,y.node.subLabel?.color,y.node.subLabel?.stroke]),el=(0,o.useMemo)(()=>K&&l&&(0,r.jsx)(B.E,{prepend:!0,center:!0,children:l({data:b,canCollapse:W,isCollapsed:P,onCollapse:X,onClose:()=>Q(!1)})}),[K,l,b,W,P,X]);return(0,r.jsxs)(L.a.group,{renderOrder:1,userData:{id:n,type:"node"},ref:q,position:Z,onPointerOver:er,onPointerOut:eo,onClick:e=>{t||N||s?.(b,{canCollapse:W,isCollapsed:P},e)},onDoubleClick:e=>{t||N||d?.(b,e)},onContextMenu:()=>{t||(Q(!0),g?.(b,{canCollapse:W,isCollapsed:P,onCollapse:X}))},...ee(),children:[ei,el,ea]})};function td(e,t){let n=t.position.z;return e<n?e-=n:e+=n,2*Math.tan(t.fov/t.zoom*Math.PI/180/2)*Math.abs(e)}function tc(e,t){let n=td(1,e)*e.aspect,r=td(1,e),o={x0:e?.position?.x-n/2,x1:e?.position?.x+n/2,y0:e?.position?.y-r/2,y1:e?.position?.y+r/2};return t?.x>o.x0&&t?.x<o.x1&&t?.y>o.y0&&t?.y<o.y1}function tu(e,t){return t.reduce((t,n)=>Math.abs(n-e%Math.PI)<Math.abs(t-e%Math.PI)?n:t)}function tf(e,t){return{horizontalRotation:tu(e,[0,Math.PI])-e%Math.PI,verticalRotation:tu(t,[Math.PI/2,3*Math.PI/2])-t%Math.PI}}let tg=(0,o.forwardRef)(({onNodeClick:e,onNodeDoubleClick:t,onNodeContextMenu:n,onEdgeContextMenu:a,onEdgeClick:s,onEdgePointerOver:d,onEdgePointerOut:c,onNodePointerOver:u,onNodePointerOut:f,onClusterClick:g,onNodeDragged:p,onClusterDragged:h,onClusterPointerOver:m,onClusterPointerOut:y,contextMenu:b,animated:v,disabled:x,draggable:C,constrainDragging:w=!1,edgeLabelPosition:E,edgeArrowPosition:k,edgeInterpolation:z="linear",labelFontUrl:M,renderNode:P,onRenderCluster:A,aggregateEdges:O,...j},I)=>{let{layoutType:S,clusterAttribute:N,labelType:L}=j,_=(0,i.C)(e=>e.gl),D=(0,i.C)(e=>e.scene),R=(0,i.C)(e=>e.camera),{updateLayout:T}=eH({...j,constrainDragging:w});if(N&&"forceDirected2d"!==S&&"forceDirected3d"!==S)throw Error("Clustering is only supported for the force directed layouts.");let B=eU(e=>e.graph),F=eU(e=>e.nodes),$=eU(e=>e.edges),V=eU(e=>e.setEdges),q=eU(e=>[...e.clusters.values()]),U=(0,o.useMemo)(()=>O?((e,t)=>{if(!e||0===e.size)return[];let n=e.reduceEdges((e,t,n,r,o)=>{let i=`${r}-${o}`,a={id:t,source:r,target:o,...n},l=e.get(i);return l?l.push(a):e.set(i,[a]),e},new Map),r=[],o="all"===t||"edges"===t;for(let[e,t]of n){let[n,i]=e.split("-"),a=t[0];if(!n||!i||!a)continue;let l=a.size||1,s=l+t.length*l*.5,d=t.length>1,c=d?`${t.length} edges`:a.label,u={...a,source:n,target:i,label:c,labelVisible:o,size:s,data:{...a.data||{},originalEdges:t,count:t.length,isAggregated:d,originalSize:l}};r.push(u)}return r})(B,L):$,[$,O,B,L]);(0,o.useEffect)(()=>{O&&$.length!==U.length&&V(U)},[U,$.length,V,O]);let{centerNodesById:G,fitNodesInViewById:K,isCentered:Q}=(({animated:e,disabled:t,layoutType:n})=>{let r=eU(e=>e.nodes),[a,s]=(0,o.useState)(!1),d=(0,i.C)(e=>e.invalidate),{controls:c}=eJ(),u=(0,i.C)(e=>e.camera),f=(0,o.useRef)(!1),g=(0,o.useCallback)(async(e,t)=>{let n=t?.animated===void 0||t?.animated,r=t?.centerOnlyIfNodesNotInView!==void 0&&t?.centerOnlyIfNodesNotInView;if(!f.current||!r||r&&e?.some(e=>!tc(u,e.position))){let{x:t,y:r,z:o}=eS(e);await c.normalizeRotations().setTarget(t,r,o,n),a||s(!0),d()}},[d,c,r]),p=(0,o.useCallback)(async(e,t={animated:!0,fitOnlyIfNodesNotInView:!1})=>{let{fitOnlyIfNodesNotInView:r}=t;if(!r||r&&e?.some(e=>!tc(u,e.position))){let{minX:r,maxX:o,minY:i,maxY:a,minZ:s,maxZ:d}=eS(e);if(!n.includes("3d")){let{horizontalRotation:e,verticalRotation:t}=tf(c?.azimuthAngle,c?.polarAngle);c?.rotate(e,t,!0)}await c?.zoomTo(1,t?.animated),await c?.fitToBox(new l.NRn(new l.Pq0(r,i,s),new l.Pq0(o,a,d)),t?.animated,{cover:!1,paddingLeft:50,paddingRight:50,paddingBottom:50,paddingTop:50})}},[u,c,n]),h=(0,o.useCallback)(e=>{let t=null;return e?.length&&(t=e.reduce((e,t)=>{let n=r.find(e=>e.id===t);if(n)e.push(n);else throw Error(`Attempted to center ${t} but it was not found in the nodes`);return e},[])),t},[r]),m=(0,o.useCallback)((t,n)=>{g(h(t)||r,{animated:e,centerOnlyIfNodesNotInView:n?.centerOnlyIfNodesNotInView})},[e,g,h,r]),y=(0,o.useCallback)(async(t,n)=>{let o=h(t);await p(o||r,{animated:e,...n})},[e,p,h,r]);return(0,o.useLayoutEffect)(()=>{!async function(){c&&r?.length&&!f.current&&(await g(r,{animated:!1}),await p(r,{animated:!1}),f.current=!0)}()},[c,g,r,e,u,p]),{centerNodes:g,centerNodesById:m,fitNodesInViewById:y,isCentered:a}})({animated:v,disabled:x,layoutType:S});(0,o.useImperativeHandle)(I,()=>({centerGraph:G,fitNodesInView:K,graph:B,renderScene:()=>_.render(D,R)}),[G,K,B,_,D,R]);let H=(0,o.useCallback)(e=>{p?.(e),N&&T()},[N,p,T]),Y=(0,o.useMemo)(()=>F.map(o=>(0,r.jsx)(ts,{id:o?.id,labelFontUrl:M,draggable:C,constrainDragging:w,disabled:x,animated:v,contextMenu:b,renderNode:P,onClick:e,onDoubleClick:t,onContextMenu:n,onPointerOver:u,onPointerOut:f,onDragged:H},o?.id)),[w,v,b,x,C,M,F,e,n,t,H,f,u,P]),W=(0,o.useMemo)(()=>v?U.map(e=>(0,r.jsx)(e6,{id:e.id,disabled:x,animated:v,labelFontUrl:M,labelPlacement:E,arrowPlacement:k,interpolation:z,contextMenu:b,onClick:s,onContextMenu:a,onPointerOver:d,onPointerOut:c},e.id)):(0,r.jsx)(te,{edges:U,disabled:x,animated:v,labelFontUrl:M,labelPlacement:E,arrowPlacement:k,interpolation:z,contextMenu:b,onClick:s,onContextMenu:a,onPointerOver:d,onPointerOut:c}),[v,b,x,k,z,E,U,M,s,a,c,d]),X=(0,o.useMemo)(()=>q.map(e=>(0,r.jsx)(e1,{animated:v,disabled:x,draggable:C,labelFontUrl:M,onClick:g,onPointerOver:m,onPointerOut:y,onDragged:h,onRender:A,...e},e.label)),[v,q,x,C,M,g,y,m,h,A]);return Q&&(0,r.jsxs)(o.Fragment,{children:[W,Y,X]})});q.default.install({THREE:{MOUSE:l.kBv,Vector2:l.I9Y,Vector3:l.Pq0,Vector4:l.IUQ,Quaternion:l.PTz,Matrix4:l.kn4,Spherical:l.YHV,Box3:l.NRn,Sphere:l.iyt,Raycaster:l.tBo,MathUtils:{DEG2RAD:l.cj9?.DEG2RAD,clamp:l.cj9?.clamp}}}),(0,i.e)({ThreeCameraControls:q.default});let tp=(0,o.forwardRef)(({mode:e="rotate",children:t,animated:n,disabled:a,minDistance:s=1e3,maxDistance:d=5e4},c)=>{let u=(0,o.useRef)(null),f=(0,i.C)(e=>e.camera),g=(0,i.C)(e=>e.gl),p="orbit"===e,h=eU(e=>e.setPanning),m=eU(e=>e.draggingIds.length>0),y=(0,o.useRef)(0),[b,v]=(0,o.useState)(!1);(0,i.D)((e,t)=>{u.current?.enabled&&u.current?.update(t),p&&(u.current.azimuthAngle+=20*t*l.cj9.DEG2RAD)},-1),(0,o.useEffect)(()=>()=>u.current?.dispose(),[]);let x=(0,o.useCallback)(()=>{u.current?.zoom(f.zoom/2,n)},[n,f.zoom]),C=(0,o.useCallback)(()=>{u.current?.zoom(-f.zoom/2,n)},[n,f.zoom]),w=(0,o.useCallback)(e=>{u.current?.dolly(e,n)},[n]),E=(0,o.useCallback)(e=>{u.current?.dolly(e,n)},[n]),k=(0,o.useCallback)(e=>{p||u.current?.truck(-.03*e.deltaTime,0,n)},[n,p]),z=(0,o.useCallback)(e=>{p||u.current?.truck(.03*e.deltaTime,0,n)},[n,p]),M=(0,o.useCallback)(e=>{p||u.current?.truck(0,.03*e.deltaTime,n)},[n,p]),P=(0,o.useCallback)(e=>{p||u.current?.truck(0,-.03*e.deltaTime,n)},[n,p]),A=(0,o.useCallback)(t=>{"Space"===t.code&&("rotate"===e?u.current.mouseButtons.left=q.default.ACTION.TRUCK:u.current.mouseButtons.left=q.default.ACTION.ROTATE)},[e]),O=(0,o.useCallback)(t=>{"Space"===t.code&&("rotate"===e?u.current.mouseButtons.left=q.default.ACTION.ROTATE:u.current.mouseButtons.left=q.default.ACTION.TRUCK)},[e]),[j,I]=(0,o.useState)(null);(0,o.useEffect)(()=>{ef||I({leftKey:new U.KeyboardKeyHold("ArrowLeft",100),rightKey:new U.KeyboardKeyHold("ArrowRight",100),upKey:new U.KeyboardKeyHold("ArrowUp",100),downKey:new U.KeyboardKeyHold("ArrowDown",100)})},[]),(0,o.useEffect)(()=>(!a&&j&&(j.leftKey.addEventListener("holding",z),j.rightKey.addEventListener("holding",k),j.upKey.addEventListener("holding",M),j.downKey.addEventListener("holding",P),window.addEventListener("keydown",A),window.addEventListener("keyup",O)),()=>{j&&(j.leftKey.removeEventListener("holding",z),j.rightKey.removeEventListener("holding",k),j.upKey.removeEventListener("holding",M),j.downKey.removeEventListener("holding",P),window.removeEventListener("keydown",A),window.removeEventListener("keyup",O))}),[a,A,O,P,z,k,M,j]),(0,o.useEffect)(()=>{a?(u.current.mouseButtons.left=q.default.ACTION.NONE,u.current.mouseButtons.middle=q.default.ACTION.NONE,u.current.mouseButtons.wheel=q.default.ACTION.NONE):(u.current.mouseButtons.left=q.default.ACTION.TRUCK,u.current.mouseButtons.middle=q.default.ACTION.TRUCK,u.current.mouseButtons.wheel=q.default.ACTION.DOLLY)},[a]),(0,o.useEffect)(()=>{let e=()=>h(!0),t=()=>h(!1),n=u.current;return n&&(n.addEventListener("control",e),n.addEventListener("controlend",t)),()=>{n&&(n.removeEventListener("control",e),n.removeEventListener("controlend",t))}},[u,h]),(0,o.useEffect)(()=>{m?(u.current.mouseButtons.left=q.default.ACTION.NONE,u.current.touches.one=q.default.ACTION.NONE):"rotate"===e?(u.current.mouseButtons.left=q.default.ACTION.ROTATE,u.current.touches.one=q.default.ACTION.TOUCH_ROTATE):(u.current.touches.one=q.default.ACTION.TOUCH_TRUCK,u.current.mouseButtons.left=q.default.ACTION.TRUCK)},[m,e]);let S=(0,o.useMemo)(()=>({controls:u.current,zoomIn:()=>x(),zoomOut:()=>C(),dollyIn:(e=1e3)=>w(e),dollyOut:(e=-1e3)=>E(e),panLeft:(e=100)=>z({deltaTime:e}),panRight:(e=100)=>k({deltaTime:e}),panDown:(e=100)=>P({deltaTime:e}),panUp:(e=100)=>M({deltaTime:e}),resetControls:e=>u.current?.normalizeRotations().reset(e),freeze:()=>{u.current.truckSpeed&&(y.current=u.current.truckSpeed),u.current.truckSpeed=0},unFreeze:()=>u.current.truckSpeed=y.current}),[x,C,z,k,P,M,u.current]);return(0,o.useImperativeHandle)(c,()=>S),(0,r.jsxs)(eZ.Provider,{value:S,children:[(0,r.jsx)("threeCameraControls",{ref:e=>{u.current=e,b||v(!0)},args:[f,g.domElement],smoothTime:.1,minDistance:s,dollyToCursor:!0,maxDistance:d}),t]})}),th={canvas:{background:"#1E2026"},node:{fill:"#7A8C9E",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.2,label:{stroke:"#1E2026",color:"#ACBAC7",activeColor:"#1DE9AC"},subLabel:{stroke:"#1E2026",color:"#ACBAC7",activeColor:"#1DE9AC"}},lasso:{border:"1px solid #55aaff",background:"rgba(75, 160, 255, 0.1)"},ring:{fill:"#54616D",activeFill:"#1DE9AC"},edge:{fill:"#474B56",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#1E2026",color:"#ACBAC7",activeColor:"#1DE9AC",fontSize:6},subLabel:{stroke:"#1E2026",color:"#ACBAC7",activeColor:"#1DE9AC"}},arrow:{fill:"#474B56",activeFill:"#1DE9AC"},cluster:{stroke:"#474B56",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#1E2026",color:"#ACBAC7"}}},tm={canvas:{background:"#fff"},node:{fill:"#7CA0AB",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.2,label:{color:"#2A6475",stroke:"#fff",activeColor:"#1DE9AC"},subLabel:{color:"#ddd",stroke:"transparent",activeColor:"#1DE9AC"}},lasso:{border:"1px solid #55aaff",background:"rgba(75, 160, 255, 0.1)"},ring:{fill:"#D8E6EA",activeFill:"#1DE9AC"},edge:{fill:"#D8E6EA",activeFill:"#1DE9AC",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475",activeColor:"#1DE9AC",fontSize:6},subLabel:{color:"#ddd",stroke:"transparent",activeColor:"#1DE9AC"}},arrow:{fill:"#D8E6EA",activeFill:"#1DE9AC"},cluster:{stroke:"#D8E6EA",opacity:1,selectedOpacity:1,inactiveOpacity:.1,label:{stroke:"#fff",color:"#2A6475"}}};function ty(e,t,n){t=Array.isArray(t)?t:[t];let r=[],o=[];for(let i of t){let t=[...e.inEdgeEntries(i)??[],...e.outEdgeEntries(i)??[]];if(t)for(let e of t){let t=e.attributes.id;if("in"===n?e.target!==i||o.includes(t)||o.push(t):"out"===n?e.source!==i||o.includes(t)||o.push(t):o.includes(t)||o.push(t),"out"===n||"all"===n){let t=e.target;r.includes(t)||r.push(t)}"in"!==n&&"all"!==n||r.includes(e.source)||r.push(e.source)}}return{nodes:r,edges:o}}function tb(e,t,n){let{offsetX:r,offsetY:o}=e,{width:i,height:a}=n;t.set(r/i*2-1,-(o/a*2)+1)}function tv(e){let t=document.createElement("div");return t.style.pointerEvents="none",t.style.border=e.lasso.border,t.style.backgroundColor=e.lasso.background,t.style.position="fixed",t}let tx=({children:e,type:t="none",onLasso:n,onLassoEnd:a,disabled:s})=>{let d=eU(e=>e.theme),c=(0,i.C)(e=>e.camera),u=(0,i.C)(e=>e.gl),f=(0,i.C)(e=>e.setEvents),g=(0,i.C)(e=>e.size),p=(0,i.C)(e=>e.get),h=(0,i.C)(e=>e.scene),m=eJ(),y=eU(e=>e.actives),b=eU(e=>e.setActives),v=eU(e=>e.edges),x=eU(e=>e.edgeMeshes),C=(0,o.useRef)(null),w=(0,o.useRef)(null),E=(0,o.useRef)(tv(d)),k=(0,o.useRef)(null),z=(0,o.useRef)(!1),M=(0,o.useRef)(p().events.enabled),P=(0,o.useRef)(m.controls?.enabled),A=(0,o.useCallback)(e=>{if(z.current){let[r,o,i]=k.current;i.x=Math.max(r.x,e.clientX),i.y=Math.max(r.y,e.clientY),o.x=Math.min(r.x,e.clientX),o.y=Math.min(r.y,e.clientY),E.current.style.left=`${o.x}px`,E.current.style.top=`${o.y}px`,E.current.style.width=`${i.x-o.x}px`,E.current.style.height=`${i.y-o.y}px`,tb(e,C.current.endPoint,g),tb(e,w.current.endPoint,g);let a=[],l=w.current.select().sort(e=>e.uuid).filter(e=>e.geometry?.userData?.type===t||"all"===t).map(e=>v[x.indexOf(e)].id);a.push(...l);let s=C.current.select().sort(e=>e.uuid).filter(e=>e.isMesh&&e.userData?.id&&(e.userData?.type===t||"all"===t)).map(e=>e.userData.id);a.push(...s),requestAnimationFrame(()=>{b(a),n?.(a)}),document.addEventListener("pointermove",A,{passive:!0,capture:!0,once:!0})}},[g,v,x,t,b,n]),O=(0,o.useCallback)(()=>{z.current&&(f({enabled:M.current}),z.current=!1,E.current.parentElement?.removeChild(E.current),m.controls.enabled=P.current,a?.(y),document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",O))},[f,m.controls,a,y,A]),j=(0,o.useCallback)(e=>{if(e.shiftKey){M.current=p().events.enabled,P.current=m.controls?.enabled,C.current=new S.g(c,h);let t=new l.Z58;x.length&&t.add(...x),w.current=new S.g(c,t),k.current=[new l.I9Y,new l.I9Y,new l.I9Y];let[n]=k.current;m.controls.enabled=!1,f({enabled:!1}),z.current=!0,u.domElement.parentElement?.appendChild(E.current),E.current.style.left=`${e.clientX}px`,E.current.style.top=`${e.clientY}px`,E.current.style.width="0px",E.current.style.height="0px",n.x=e.clientX,n.y=e.clientY,tb(e,C.current.startPoint,g),tb(e,w.current.startPoint,g),document.addEventListener("pointermove",A,{passive:!0,capture:!0,once:!0}),document.addEventListener("pointerup",O,{passive:!0})}},[c,m.controls,x,p,u.domElement.parentElement,A,O,h,f,g]);return(0,o.useEffect)(()=>{if(!s&&"none"!==t)return"undefined"!=typeof window&&(document.addEventListener("pointerdown",j,{passive:!0}),document.addEventListener("pointermove",A,{passive:!0}),document.addEventListener("pointerup",O,{passive:!0})),()=>{"undefined"!=typeof window&&(document.removeEventListener("pointerdown",j),document.removeEventListener("pointermove",A),document.removeEventListener("pointerup",O))}},[t,s,j,A,O]),(0,r.jsx)("group",{children:e})},tC={canvas:"_canvas_670zp_1"},tw={alpha:!0,antialias:!0},tE={position:[0,0,1e3],near:5,far:5e4,fov:10},tk=(0,o.forwardRef)(({cameraMode:e="pan",layoutType:t="forceDirected2d",sizingType:n="default",labelType:i="auto",theme:l=tm,animated:s=!0,defaultNodeSize:d=7,minNodeSize:c=5,maxNodeSize:u=15,lassoType:f="none",glOptions:g={},edges:p,children:h,nodes:m,minDistance:y,maxDistance:b,onCanvasClick:v,disabled:x,onLasso:C,onLassoEnd:w,aggregateEdges:E,...k},z)=>{let M=(0,o.useRef)(null),P=(0,o.useRef)(null),A=(0,o.useRef)(null);(0,o.useImperativeHandle)(z,()=>({centerGraph:(e,t)=>M.current?.centerGraph(e,t),fitNodesInView:(e,t)=>M.current?.fitNodesInView(e,t),zoomIn:()=>{let e=P.current?.controls;if(!e)return;let t=e.distance,n=e.camera.zoom;(!y||t/(n+n/2)>=y)&&P.current?.zoomIn()},zoomOut:()=>{let e=P.current?.controls;if(!e)return;let t=e.distance,n=e.camera.zoom;(!b||t/(n-n/2)<=b)&&P.current?.zoomOut()},dollyIn:e=>P.current?.dollyIn(e),dollyOut:e=>P.current?.dollyOut(e),panLeft:()=>P.current?.panLeft(),panRight:()=>P.current?.panRight(),panDown:()=>P.current?.panDown(),panUp:()=>P.current?.panUp(),resetControls:e=>P.current?.resetControls(e),getControls:()=>P.current?.controls,getGraph:()=>M.current?.graph,exportCanvas:()=>(M.current.renderScene(),A.current.toDataURL()),freeze:()=>P.current?.freeze(),unFreeze:()=>P.current?.unFreeze()}));let{selections:O,actives:j,collapsedNodeIds:I}=k,S=!(p.length+m.length>400)&&s,N=(0,o.useMemo)(()=>({...g,...tw}),[g]),L=(0,o.useRef)(eF({selections:O,actives:j,theme:l,collapsedNodeIds:I})).current;return(0,o.useEffect)(()=>{L.getState().setTheme(l)},[l,L]),(0,r.jsx)("div",{className:tC.canvas,children:(0,r.jsx)(a.Canvas,{legacy:!0,linear:!0,ref:A,flat:!0,gl:N,camera:tE,onPointerMissed:v,children:(0,r.jsxs)(eq,{store:L,children:[l.canvas?.background&&(0,r.jsx)("color",{attach:"background",args:[l.canvas.background]}),(0,r.jsx)("ambientLight",{intensity:1}),h,l.canvas?.fog&&(0,r.jsx)("fog",{attach:"fog",args:[l.canvas.fog,4e3,9e3]}),(0,r.jsx)(tp,{mode:e,ref:P,disabled:x,minDistance:y,maxDistance:b,animated:s,children:(0,r.jsx)(tx,{disabled:x,type:f,onLasso:C,onLassoEnd:w,children:(0,r.jsx)(o.Suspense,{children:(0,r.jsx)(tg,{ref:M,disabled:x,animated:S,edges:p,nodes:m,layoutType:t,sizingType:n,labelType:i,defaultNodeSize:d,minNodeSize:c,maxNodeSize:u,aggregateEdges:E,...k})})})})]})})})}),tz=({selections:e=[],nodes:t=[],actives:n=[],focusOnSelect:r=!0,type:i="single",pathHoverType:a="out",pathSelectionType:l="direct",ref:s,disabled:d,onSelection:c})=>{let[u,f]=(0,o.useState)([]),[g,p]=(0,o.useState)(n),[h,m]=(0,o.useState)(e),[y,b]=(0,o.useState)(!1),v="multi"===i||"multiModifier"===i,x=(0,o.useCallback)(e=>{if(!d&&e){let t=(e=Array.isArray(e)?e:[e]).filter(e=>!h.includes(e));if(t.length){let e=[...h,...t];c?.(e),m(e)}}},[d,h,c]),C=(0,o.useCallback)(e=>{if(!d&&e){e=Array.isArray(e)?e:[e];let t=h.filter(t=>!e.includes(t));c?.(t),m(t)}},[d,h,c]),w=(0,o.useCallback)((e=[])=>{d||(e=Array.isArray(e)?e:[e],p([]),m(e),c?.(e))},[d,c]),E=(0,o.useCallback)(e=>{h.includes(e)?C(e):v?x(e):w(e)},[x,w,h,v,C]),k=(0,o.useCallback)(e=>{if(v?"multiModifier"===i?y?x(e.id):w(e.id):x(e.id):w(e.id),!0===r||"singleOnly"===r&&!y){if(!s.current)throw Error("No ref found for the graph canvas.");let{nodes:t}=ty(s.current.getGraph(),[e.id],l);s.current.fitNodesInView([e.id,...t],{fitOnlyIfNodesNotInView:!0})}},[x,w,r,v,y,l,s,i]),z=(0,o.useCallback)((e,t)=>{let n=s.current.getGraph();if(!n)throw Error("Graph is not initialized");let r=e_(n,e,t);w([e,t]);let o=[];for(let e=0;e<r.length-1;e++){let t=r[e],i=r[e+1],a=n.getEdgeAttributes(t,i);a&&o.push(a.id)}p([...r.map(e=>e),...o])},[w,s]),M=(0,o.useCallback)(e=>{let t=eD(e.target),n=e.metaKey||e.ctrlKey;t&&n&&b(!0)},[]),P=(0,o.useCallback)(e=>{let t=eD(e.target),n=["Meta","Control"].includes(e.key);t&&n&&b(!1)},[]);(0,o.useEffect)(()=>("undefined"!=typeof window&&(window.addEventListener("keydown",M),window.addEventListener("keyup",P)),()=>{"undefined"!=typeof window&&(window.removeEventListener("keydown",M),window.removeEventListener("keyup",P))}),[M,P]);let A=(0,o.useCallback)(e=>{if(2!==e.button&&(h.length||g.length)&&(w(),b(!1),r&&1===h.length)){if(!s.current)throw Error("No ref found for the graph canvas.");s.current.fitNodesInView([],{fitOnlyIfNodesNotInView:!0})}},[w,r,g.length,h.length,s]),O=(0,o.useCallback)(e=>{p(e)},[]),j=(0,o.useCallback)(e=>{w(e)},[w]),I=(0,o.useCallback)(e=>{if(a){let t=s.current.getGraph();if(!t)throw Error("No ref found for the graph canvas.");let{nodes:n,edges:r}=ty(t,[e.id],a);f([...n,...r])}},[a,s]),S=(0,o.useCallback)(()=>{a&&f([])},[a]);return(0,o.useEffect)(()=>{if("direct"!==l&&h.length>0){let e=s.current?.getGraph();if(e){let{nodes:t,edges:n}=ty(e,h,l);p([...t,...n])}}},[h,l,s]),{actives:(0,o.useMemo)(()=>[...g,...u],[g,u]),onNodeClick:k,onNodePointerOver:I,onNodePointerOut:S,onLasso:O,onLassoEnd:j,selectNodePaths:z,onCanvasClick:A,selections:h,clearSelections:w,addSelection:x,removeSelection:C,toggleSelection:E,setSelections:m}},tM={container:"_container_155l7_1",disabled:"_disabled_155l7_7",contentContainer:"_contentContainer_155l7_10",contentInner:"_contentInner_155l7_35",content:"_content_155l7_10"},tP=({label:e,centralAngle:t,startAngle:n,endAngle:o,polar:i,radius:a,className:l,icon:s,innerRadius:d,skew:c,disabled:u,onClick:f})=>(0,r.jsx)("div",{role:"menuitem",className:G(tM.container,l,{[tM.disabled]:u}),style:{width:t>90?"100%":"50%",height:t>90?"100%":"50%",bottom:t>90?"50%":"initial",right:t>90?"50%":"initial",transform:`rotate(${n+o}deg) skew(${c}deg)`},onClick:e=>{u||f(e)},children:(0,r.jsx)("div",{className:tM.contentContainer,style:{transform:`skew(${-c}deg) rotate(${(i?90:t)/2-90}deg)`},children:(0,r.jsx)("div",{className:tM.contentInner,style:{top:`calc((((${t>90?"50% + ":""}${a}px) - ${d}px) / 2) - 4em)`},children:(0,r.jsxs)("div",{className:tM.content,style:{transform:`rotate(${-o}deg)`},title:e,children:[s,e]})})})}),tA={container:"_container_x9hyx_1"},tO=({items:e,radius:t=175,className:n,innerRadius:i=25,startOffsetAngle:a=0,onClose:l})=>{let{centralAngle:s,polar:d,startAngle:c,deltaAngle:u}=(0,o.useMemo)(()=>(function(e,t){let n=360/e.length||360,r=n%180==0,o=90-n;return{centralAngle:n,polar:r,startAngle:r?45:t+o+n/2,deltaAngle:o}})(e,a),[e,a]),f=(0,o.useRef)(null);return((0,o.useLayoutEffect)(()=>{let e=f.current;return()=>clearTimeout(e)},[]),0===e.length)?null:(0,r.jsx)("div",{role:"menu",className:G(tA.container,n),onPointerEnter:()=>clearTimeout(f.current),onPointerLeave:e=>{clearTimeout(f.current),f.current=setTimeout(()=>l?.(e),500)},children:e.map((e,n)=>(0,r.jsx)(tP,{...e,radius:t,innerRadius:i,startAngle:c,endAngle:s*n,skew:d?0:u,polar:d,centralAngle:s,onClick:t=>{e?.onClick(t),l?.(t)}},n))})}}}]);